<!DOCTYPE HTML>
<html>
<head>
	<title>YUI 3 ExpressionBuilder Example</title>
	<meta http-equiv=content-type content="text/html; charset=utf-8">

	<script src="http://jafl.github.io/yui3/build/yui/yui-min.js"></script>
	<link rel="stylesheet" type="text/css" href="http://jafl.github.io/yui3/build/cssreset/cssreset-min.css">
<!--
	<script src="gallery-exprbuilder-debug.js"></script>
	<script src="gallery-querybuilder-debug.js"></script>
	<script src="gallery-formmgr-debug.js"></script>
	<script src="gallery-formmgr-css-validation-debug.js"></script>
	<link rel="stylesheet" type="text/css" href="assets/gallery-querybuilder.css" />
	<link rel="stylesheet" type="text/css" href="assets/gallery-exprbuilder.css" />
-->
	<style type="text/css">
	#expr_row
	{
		margin-top: 10px;
		border: 1px solid black;
		padding: 10px;
	}

	#sql-expr
	{
		width: 40em;
	}

	.formmgr-haserror .formmgr-message-text
	{
		color: #BE1E2D;
	}

	fieldset textarea.formmgr-haserror
	{
		background-color: #FFCCCC;
	}

	#controls
	{
		margin-top: 10px;
	}
	</style>
</head>
<body class="yui3-skin-sam">

<h1><a href="http://yuilibrary.com/gallery/show/exprbuilder">YUI 3 ExpressionBuilder</a> Example</h1>

<form name="expr_form">
	<fieldset>
		<div id="expr_row" class="formmgr-row">
			<label for="sql-expr">SQL Expression</label>
			<p class="formmgr-message-text"></p>
			<div id="expr"></div>
		</div>
	</fieldset>
</form>

<div id="controls">
	<button id="validate">Validate</button>
</div>

<p>For a simpler way to build a query, see <a href="http://yuilibrary.com/gallery/show/querybuilder">Query Builder</a>.

<p><a href="../yuidoc/modules/gallery-exprbuilder.html">Show me the documentation</a></p>
<p><a href="/yui-modules/">Back to project list</a></p>

<script type="text/javascript">
YUI({
//	filter: 'raw', combine: false,
	gallery: 'gallery-2014.02.20-23-55'
}).use('gallery-exprbuilder', 'cssbutton', function(Y)
{
	var var_list =
	[
		{
			name: 'url',
			type: 'string',
			text: 'URL',
			validation: 'yiv-length:[,3000]'
		},
		{
			name: 'impressions',
			type: 'number',
			text: 'Impressions (1000\'s)',
			validation: 'yiv-integer'
		},
		{
			name: 'ctr',
			type: 'number',
			text: 'Click-through rate (%)',
			validation: 'yiv-decimal:[0,]'
		},
		{
			name: 'flag',
			type: 'select',
			text: 'Flagged',
			value_list:
			[
				{ value: "true",  text: 'True' },
				{ value: "false", text: 'False' }
			]
		},
		{
			name: 'submission_status',
			type: 'select',
			text: 'Status',
			value_list:
			[
				{ value: "I", text: 'Action Required' },
				{ value: "S", text: 'Submitted' },
				{ value: "A", text: 'Submission Accepted' },
				{ value: "B", text: 'Submission Auto-Accepted' }
			]
		}
	];

	var ops =
	{
		string:
		[
			{ value: " = '{value}'",      text: 'Is' },
			{ value: " LIKE '%{value}%'", text: 'Contains' },
			{ value: " LIKE '{value}%'",  text: 'Starts with' },
			{ value: " LIKE '%{value}'",  text: 'Ends with' }
		],

		number:
		[
			{ value: ' = ',  text: '= Equals' },
			{ value: ' < ',  text: '< Less than' },
			{ value: ' <= ', text: '<= Less than or equal to' },
			{ value: ' > ',  text: '> Greater than' },
			{ value: ' >= ', text: '>= Greater than or equal to' }
		],

		select:
		[
			" = '{value}'"
		]
	};

	var query = new Y.QueryBuilder(var_list, ops);
	// rendered by ExpressionBuilder

	var form = new Y.FormManager('expr_form');
	form.prepareForm();

	var expr = new Y.ExpressionBuilder(
	{
		fieldName:    'sql_expr',
		fieldId:      'sql-expr',
		formMgr:      form,
		queryBuilder: query

		// There is no need to define combinatorMap in this example,
		// but you should check the documentation and know about it,
		// in case you need it!
	});
	expr.render('#expr');

	Y.on('click', form.validateForm, '#validate', form);
});
</script>

</body>
</html>
