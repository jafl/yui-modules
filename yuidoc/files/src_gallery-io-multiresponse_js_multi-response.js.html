<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/gallery-io-multiresponse/js/multi-response.js - YUI 3 Gallery Modules</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="YUI 3 Gallery Modules" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Accordion.html">Accordion</a></li>
                                <li><a href="../classes/AnimSequence.html">AnimSequence</a></li>
                                <li><a href="../classes/ArrayIterator.html">ArrayIterator</a></li>
                                <li><a href="../classes/ArrayList~extras.html">ArrayList~extras</a></li>
                                <li><a href="../classes/Array~algorithms.html">Array~algorithms</a></li>
                                <li><a href="../classes/Array~funcprog-extras.html">Array~funcprog-extras</a></li>
                                <li><a href="../classes/Array~object-extras.html">Array~object-extras</a></li>
                                <li><a href="../classes/Assert.html">Assert</a></li>
                                <li><a href="../classes/AtLeastOneCheckboxGroup.html">AtLeastOneCheckboxGroup</a></li>
                                <li><a href="../classes/AtMostOneCheckboxGroup.html">AtMostOneCheckboxGroup</a></li>
                                <li><a href="../classes/BulkEditor.html">BulkEditor</a></li>
                                <li><a href="../classes/Canvas.Context2d.html">Canvas.Context2d</a></li>
                                <li><a href="../classes/CheckboxGroup.html">CheckboxGroup</a></li>
                                <li><a href="../classes/Chipper.html">Chipper</a></li>
                                <li><a href="../classes/CollapseToggle.html">CollapseToggle</a></li>
                                <li><a href="../classes/ComplexMath.html">ComplexMath</a></li>
                                <li><a href="../classes/ComplexNumber.html">ComplexNumber</a></li>
                                <li><a href="../classes/DataSource.AsyncFunction.html">DataSource.AsyncFunction</a></li>
                                <li><a href="../classes/DataSource.BulkEdit.html">DataSource.BulkEdit</a></li>
                                <li><a href="../classes/DataSource.Treeble.html">DataSource.Treeble</a></li>
                                <li><a href="../classes/DateTime.html">DateTime</a></li>
                                <li><a href="../classes/DateTimeRange.html">DateTimeRange</a></li>
                                <li><a href="../classes/DateTimeUtils.html">DateTimeUtils</a></li>
                                <li><a href="../classes/EnableIfAnyCheckboxGroup.html">EnableIfAnyCheckboxGroup</a></li>
                                <li><a href="../classes/ExpirationCache.html">ExpirationCache</a></li>
                                <li><a href="../classes/ExpressionBuilder.html">ExpressionBuilder</a></li>
                                <li><a href="../classes/FormManager.html">FormManager</a></li>
                                <li><a href="../classes/HTMLTableBulkEditor.html">HTMLTableBulkEditor</a></li>
                                <li><a href="../classes/InputPopup.html">InputPopup</a></li>
                                <li><a href="../classes/InstanceManager.html">InstanceManager</a></li>
                                <li><a href="../classes/io~multiresponse.html">io~multiresponse</a></li>
                                <li><a href="../classes/Iterable.html">Iterable</a></li>
                                <li><a href="../classes/LinkedList.html">LinkedList</a></li>
                                <li><a href="../classes/LinkedListItem.html">LinkedListItem</a></li>
                                <li><a href="../classes/LinkedListIterator.html">LinkedListIterator</a></li>
                                <li><a href="../classes/LogFilter.html">LogFilter</a></li>
                                <li><a href="../classes/Math.html">Math</a></li>
                                <li><a href="../classes/MathCanvas.html">MathCanvas</a></li>
                                <li><a href="../classes/MathCanvas.Parser.html">MathCanvas.Parser</a></li>
                                <li><a href="../classes/MathCanvas.RectList.html">MathCanvas.RectList</a></li>
                                <li><a href="../classes/MathFunction.html">MathFunction</a></li>
                                <li><a href="../classes/MathFunction.Arccosine.html">MathFunction.Arccosine</a></li>
                                <li><a href="../classes/MathFunction.Arcsine.html">MathFunction.Arcsine</a></li>
                                <li><a href="../classes/MathFunction.Arctangent.html">MathFunction.Arctangent</a></li>
                                <li><a href="../classes/MathFunction.Arctangent2.html">MathFunction.Arctangent2</a></li>
                                <li><a href="../classes/MathFunction.Conjugate.html">MathFunction.Conjugate</a></li>
                                <li><a href="../classes/MathFunction.Cosine.html">MathFunction.Cosine</a></li>
                                <li><a href="../classes/MathFunction.E.html">MathFunction.E</a></li>
                                <li><a href="../classes/MathFunction.Exponential.html">MathFunction.Exponential</a></li>
                                <li><a href="../classes/MathFunction.FunctionWithArgs.html">MathFunction.FunctionWithArgs</a></li>
                                <li><a href="../classes/MathFunction.HyperbolicCosine.html">MathFunction.HyperbolicCosine</a></li>
                                <li><a href="../classes/MathFunction.HyperbolicSine.html">MathFunction.HyperbolicSine</a></li>
                                <li><a href="../classes/MathFunction.HyperbolicTangent.html">MathFunction.HyperbolicTangent</a></li>
                                <li><a href="../classes/MathFunction.I.html">MathFunction.I</a></li>
                                <li><a href="../classes/MathFunction.ImaginaryPart.html">MathFunction.ImaginaryPart</a></li>
                                <li><a href="../classes/MathFunction.InverseHyperbolicCosine.html">MathFunction.InverseHyperbolicCosine</a></li>
                                <li><a href="../classes/MathFunction.InverseHyperbolicSine.html">MathFunction.InverseHyperbolicSine</a></li>
                                <li><a href="../classes/MathFunction.InverseHyperbolicTangent.html">MathFunction.InverseHyperbolicTangent</a></li>
                                <li><a href="../classes/MathFunction.Logarithm.html">MathFunction.Logarithm</a></li>
                                <li><a href="../classes/MathFunction.Magnitude.html">MathFunction.Magnitude</a></li>
                                <li><a href="../classes/MathFunction.Max.html">MathFunction.Max</a></li>
                                <li><a href="../classes/MathFunction.Min.html">MathFunction.Min</a></li>
                                <li><a href="../classes/MathFunction.NaturalLog.html">MathFunction.NaturalLog</a></li>
                                <li><a href="../classes/MathFunction.Negate.html">MathFunction.Negate</a></li>
                                <li><a href="../classes/MathFunction.Phase.html">MathFunction.Phase</a></li>
                                <li><a href="../classes/MathFunction.Pi.html">MathFunction.Pi</a></li>
                                <li><a href="../classes/MathFunction.Product.html">MathFunction.Product</a></li>
                                <li><a href="../classes/MathFunction.Quotient.html">MathFunction.Quotient</a></li>
                                <li><a href="../classes/MathFunction.RealPart.html">MathFunction.RealPart</a></li>
                                <li><a href="../classes/MathFunction.Rotate.html">MathFunction.Rotate</a></li>
                                <li><a href="../classes/MathFunction.Sine.html">MathFunction.Sine</a></li>
                                <li><a href="../classes/MathFunction.SquareRoot.html">MathFunction.SquareRoot</a></li>
                                <li><a href="../classes/MathFunction.Sum.html">MathFunction.Sum</a></li>
                                <li><a href="../classes/MathFunction.Tangent.html">MathFunction.Tangent</a></li>
                                <li><a href="../classes/MathFunction.Value.html">MathFunction.Value</a></li>
                                <li><a href="../classes/MathFunction.Variable.html">MathFunction.Variable</a></li>
                                <li><a href="../classes/MatrixBackground.html">MatrixBackground</a></li>
                                <li><a href="../classes/MatrixCredits.html">MatrixCredits</a></li>
                                <li><a href="../classes/MRUCache.html">MRUCache</a></li>
                                <li><a href="../classes/MultiObject.html">MultiObject</a></li>
                                <li><a href="../classes/NodeList~extras2.html">NodeList~extras2</a></li>
                                <li><a href="../classes/Node~dimensions.html">Node~dimensions</a></li>
                                <li><a href="../classes/Node~event-set.html">Node~event-set</a></li>
                                <li><a href="../classes/Node~optimizations.html">Node~optimizations</a></li>
                                <li><a href="../classes/Node~scrollIntoView.html">Node~scrollIntoView</a></li>
                                <li><a href="../classes/Node~utils.html">Node~utils</a></li>
                                <li><a href="../classes/Object~extras.html">Object~extras</a></li>
                                <li><a href="../classes/PageLayout.html">PageLayout</a></li>
                                <li><a href="../classes/Paginator.ui.CurrentPageInput.html">Paginator.ui.CurrentPageInput</a></li>
                                <li><a href="../classes/Paginator.ui.CurrentPageReport.html">Paginator.ui.CurrentPageReport</a></li>
                                <li><a href="../classes/Paginator.ui.FirstPageLink.html">Paginator.ui.FirstPageLink</a></li>
                                <li><a href="../classes/Paginator.ui.ItemRangeDropdown.html">Paginator.ui.ItemRangeDropdown</a></li>
                                <li><a href="../classes/Paginator.ui.LastPageLink.html">Paginator.ui.LastPageLink</a></li>
                                <li><a href="../classes/Paginator.ui.NextPageLink.html">Paginator.ui.NextPageLink</a></li>
                                <li><a href="../classes/Paginator.ui.PageLinks.html">Paginator.ui.PageLinks</a></li>
                                <li><a href="../classes/Paginator.ui.PreviousPageLink.html">Paginator.ui.PreviousPageLink</a></li>
                                <li><a href="../classes/Paginator.ui.RowsPerPageDropdown.html">Paginator.ui.RowsPerPageDropdown</a></li>
                                <li><a href="../classes/Paginator.ui.ValidationPageLinks.html">Paginator.ui.ValidationPageLinks</a></li>
                                <li><a href="../classes/Parsers.html">Parsers</a></li>
                                <li><a href="../classes/Plugin.BusyOverlay.html">Plugin.BusyOverlay</a></li>
                                <li><a href="../classes/Plugin.ConsoleTest.html">Plugin.ConsoleTest</a></li>
                                <li><a href="../classes/Plugin.DataTableDataSourceBusy.html">Plugin.DataTableDataSourceBusy</a></li>
                                <li><a href="../classes/Plugin.DataTablePaginator.html">Plugin.DataTablePaginator</a></li>
                                <li><a href="../classes/Plugin.DataTableQuickEdit.html">Plugin.DataTableQuickEdit</a></li>
                                <li><a href="../classes/Plugin.DataTableRowExpansion.html">Plugin.DataTableRowExpansion</a></li>
                                <li><a href="../classes/Plugin.DataTableState.html">Plugin.DataTableState</a></li>
                                <li><a href="../classes/Plugin.FixedSizeAccordion.html">Plugin.FixedSizeAccordion</a></li>
                                <li><a href="../classes/Plugin.InputCalendarSync.html">Plugin.InputCalendarSync</a></li>
                                <li><a href="../classes/Plugin.Neon.html">Plugin.Neon</a></li>
                                <li><a href="../classes/Plugin.NodeFXSequence.html">Plugin.NodeFXSequence</a></li>
                                <li><a href="../classes/Plugin.OverlayForm.html">Plugin.OverlayForm</a></li>
                                <li><a href="../classes/Plugin.PageLayoutAnyWidgetModule.html">Plugin.PageLayoutAnyWidgetModule</a></li>
                                <li><a href="../classes/Plugin.PageLayoutDataTableModule.html">Plugin.PageLayoutDataTableModule</a></li>
                                <li><a href="../classes/Popup.html">Popup</a></li>
                                <li><a href="../classes/QueryBuilder.html">QueryBuilder</a></li>
                                <li><a href="../classes/QueryBuilder.DateRange.html">QueryBuilder.DateRange</a></li>
                                <li><a href="../classes/QueryBuilder.MultiselectInput.html">QueryBuilder.MultiselectInput</a></li>
                                <li><a href="../classes/QueryBuilder.Select.html">QueryBuilder.Select</a></li>
                                <li><a href="../classes/QueryBuilder.String.html">QueryBuilder.String</a></li>
                                <li><a href="../classes/RPC.Mojito.html">RPC.Mojito</a></li>
                                <li><a href="../classes/SelectAllCheckboxGroup.html">SelectAllCheckboxGroup</a></li>
                                <li><a href="../classes/Sort.html">Sort</a></li>
                                <li><a href="../classes/Treeble.html">Treeble</a></li>
                                <li><a href="../classes/YUI~funcprog.html">YUI~funcprog</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/gallery-accordion-horiz-vert.html">gallery-accordion-horiz-vert</a></li>
                                <li><a href="../modules/gallery-adobe-air-config.html">gallery-adobe-air-config</a></li>
                                <li><a href="../modules/gallery-adobe-air-page-manager.html">gallery-adobe-air-page-manager</a></li>
                                <li><a href="../modules/gallery-adobe-air-prefs.html">gallery-adobe-air-prefs</a></li>
                                <li><a href="../modules/gallery-algorithms.html">gallery-algorithms</a></li>
                                <li><a href="../modules/gallery-anim-class.html">gallery-anim-class</a></li>
                                <li><a href="../modules/gallery-anim-sequence.html">gallery-anim-sequence</a></li>
                                <li><a href="../modules/gallery-bulkedit.html">gallery-bulkedit</a></li>
                                <li><a href="../modules/gallery-busyoverlay.html">gallery-busyoverlay</a></li>
                                <li><a href="../modules/gallery-canvas.html">gallery-canvas</a></li>
                                <li><a href="../modules/gallery-checkboxgroups.html">gallery-checkboxgroups</a></li>
                                <li><a href="../modules/gallery-chipper.html">gallery-chipper</a></li>
                                <li><a href="../modules/gallery-collapse-toggle.html">gallery-collapse-toggle</a></li>
                                <li><a href="../modules/gallery-complexnumber.html">gallery-complexnumber</a></li>
                                <li><a href="../modules/gallery-console-test.html">gallery-console-test</a></li>
                                <li><a href="../modules/gallery-datasource-async-function.html">gallery-datasource-async-function</a></li>
                                <li><a href="../modules/gallery-datatable-datasource-busy.html">gallery-datatable-datasource-busy</a></li>
                                <li><a href="../modules/gallery-datatable-paginator.html">gallery-datatable-paginator</a></li>
                                <li><a href="../modules/gallery-datatable-row-expansion.html">gallery-datatable-row-expansion</a></li>
                                <li><a href="../modules/gallery-datatable-state.html">gallery-datatable-state</a></li>
                                <li><a href="../modules/gallery-datetime.html">gallery-datetime</a></li>
                                <li><a href="../modules/gallery-datetime-range.html">gallery-datetime-range</a></li>
                                <li><a href="../modules/gallery-datetime-utils.html">gallery-datetime-utils</a></li>
                                <li><a href="../modules/gallery-dimensions.html">gallery-dimensions</a></li>
                                <li><a href="../modules/gallery-expiration-cache.html">gallery-expiration-cache</a></li>
                                <li><a href="../modules/gallery-exprbuilder.html">gallery-exprbuilder</a></li>
                                <li><a href="../modules/gallery-formmgr.html">gallery-formmgr</a></li>
                                <li><a href="../modules/gallery-formmgr-css-validation.html">gallery-formmgr-css-validation</a></li>
                                <li><a href="../modules/gallery-formmgr-overlay-plugin.html">gallery-formmgr-overlay-plugin</a></li>
                                <li><a href="../modules/gallery-funcprog.html">gallery-funcprog</a></li>
                                <li><a href="../modules/gallery-input-calendar-sync.html">gallery-input-calendar-sync</a></li>
                                <li><a href="../modules/gallery-instancemanager.html">gallery-instancemanager</a></li>
                                <li><a href="../modules/gallery-io-adobe-air.html">gallery-io-adobe-air</a></li>
                                <li><a href="../modules/gallery-io-multiresponse.html">gallery-io-multiresponse</a></li>
                                <li><a href="../modules/gallery-iterable-extras.html">gallery-iterable-extras</a></li>
                                <li><a href="../modules/gallery-layout.html">gallery-layout</a></li>
                                <li><a href="../modules/gallery-layout-anywidget.html">gallery-layout-anywidget</a></li>
                                <li><a href="../modules/gallery-layout-cols.html">gallery-layout-cols</a></li>
                                <li><a href="../modules/gallery-layout-datatable.html">gallery-layout-datatable</a></li>
                                <li><a href="../modules/gallery-layout-rows.html">gallery-layout-rows</a></li>
                                <li><a href="../modules/gallery-linkedlist.html">gallery-linkedlist</a></li>
                                <li><a href="../modules/gallery-log-filter.html">gallery-log-filter</a></li>
                                <li><a href="../modules/gallery-math.html">gallery-math</a></li>
                                <li><a href="../modules/gallery-mathcanvas.html">gallery-mathcanvas</a></li>
                                <li><a href="../modules/gallery-matrix-background.html">gallery-matrix-background</a></li>
                                <li><a href="../modules/gallery-matrix-credits.html">gallery-matrix-credits</a></li>
                                <li><a href="../modules/gallery-mojito-rpc.html">gallery-mojito-rpc</a></li>
                                <li><a href="../modules/gallery-mru-cache.html">gallery-mru-cache</a></li>
                                <li><a href="../modules/gallery-multiobject.html">gallery-multiobject</a></li>
                                <li><a href="../modules/gallery-neon.html">gallery-neon</a></li>
                                <li><a href="../modules/gallery-node-event-set.html">gallery-node-event-set</a></li>
                                <li><a href="../modules/gallery-node-optimizations.html">gallery-node-optimizations</a></li>
                                <li><a href="../modules/gallery-node-utils.html">gallery-node-utils</a></li>
                                <li><a href="../modules/gallery-nodelist-extras2.html">gallery-nodelist-extras2</a></li>
                                <li><a href="../modules/gallery-object-extras.html">gallery-object-extras</a></li>
                                <li><a href="../modules/gallery-paginator.html">gallery-paginator</a></li>
                                <li><a href="../modules/gallery-popup.html">gallery-popup</a></li>
                                <li><a href="../modules/gallery-querybuilder.html">gallery-querybuilder</a></li>
                                <li><a href="../modules/gallery-querybuilder-daterange.html">gallery-querybuilder-daterange</a></li>
                                <li><a href="../modules/gallery-querybuilder-multiselect-input.html">gallery-querybuilder-multiselect-input</a></li>
                                <li><a href="../modules/gallery-quickedit.html">gallery-quickedit</a></li>
                                <li><a href="../modules/gallery-scrollintoview.html">gallery-scrollintoview</a></li>
                                <li><a href="../modules/gallery-sort-extras.html">gallery-sort-extras</a></li>
                                <li><a href="../modules/gallery-table-utils.html">gallery-table-utils</a></li>
                                <li><a href="../modules/gallery-test-extras.html">gallery-test-extras</a></li>
                                <li><a href="../modules/gallery-treeble.html">gallery-treeble</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/gallery-io-multiresponse/js/multi-response.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * &lt;p&gt;Extends the IO base class to enable multiple responses using an
 * iframe as the transport medium.&lt;/p&gt;
 * 
 * @module gallery-io-multiresponse
 */

/**
 * &lt;p&gt;Extends the IO base class to enable multiple responses using an
 * iframe as the transport medium.  Each response fires the response event.
 * The only events that are fired are the start and end events.&lt;/p&gt;
 * 
 * &lt;p&gt;All the YUI 3 IO features are supported, so the request can be sent
 * as either GET (for simple query args) or POST (for anything, even file
 * uploads).  The module uses an iframe to send the request and includes a
 * callback parameter.  (So you cannot include a parameter named
 * &lt;q&gt;callback&lt;/q&gt;.)  For each response, the server must send a script
 * block invoking the callback, similar to JSONP.  Unlike JSONP, however,
 * requests can only be made to your own server because the callback will
 * reference &lt;code&gt;window.parent&lt;/code&gt;.  In order to trigger script
 * parsing in all browsers, the first chunk of data that the server writes
 * to the connection must be at least 1024 bytes, and it must be part of
 * the body, so you will need to explicitly send an empty head.&lt;/p&gt;
 * 
 * &lt;p&gt;Due to the way that the request data is parsed, it is not safe to
 * send JSON-encoded data using the standard YUI 3 IO methods.  However, if
 * you define &lt;code&gt;json&lt;/code&gt; in the configuration passed to
 * &lt;code&gt;Y.io()&lt;/code&gt;, then the data will be passed to the server under
 * the &lt;code&gt;json&lt;/code&gt; parameter.  (If you pass an object, it will be
 * serialized with &lt;code&gt;Y.JSON.stringify()&lt;/code&gt;.)
 * 
 * &lt;p&gt;To keep the iframe after it has finished loading, set
 * &lt;code&gt;debug:true&lt;/code&gt; in the configuration passed to
 * &lt;code&gt;Y.io()&lt;/code&gt;.&lt;/p&gt;
 * 
 * @class io~multiresponse
 */

var L = Y.Lang,
    w = Y.config.win,
    d = Y.config.doc,
    _std = (d.documentMode &amp;&amp; d.documentMode &gt;= 8),
    _d = decodeURIComponent;

/**
 * Creates the iframe used in file upload transactions, and binds the
 * response event handler.
 *
 * @method _iframe
 * @private
 * @static
 * @param {object} o Transaction object generated by _iframe().
 * @param {object} c Configuration object passed to YUI.io().
 * @return {void}
 */
function _iframe(o, c, io) {
    var i = Y.Node.create(&#x27;&lt;iframe id=&quot;io-multi-response-&#x27; + o.id + &#x27;&quot; name=&quot;io-multi-response-&#x27; + o.id + &#x27;&quot; /&gt;&#x27;);
        i._node.style.position = &#x27;absolute&#x27;;
        i._node.style.top = &#x27;-1000px&#x27;;
        i._node.style.left = &#x27;-1000px&#x27;;

    Y.one(&#x27;body&#x27;).appendChild(i);
    // Bind the onload handler to the iframe to detect the file upload response.
    Y.on(&quot;load&quot;, function() { io._multi_complete(o, c); }, &#x27;#io-multi-response-&#x27; + o.id);
}

/**
 * Creates a temporary form, if the caller doesn&#x27;t provide one.
 *
 * @method _form
 * @private
 * @static
 * @param {object} c Configuration object passed to YUI.io().
 * @return {string} form id
 */
function _form(c) {
    var id = Y.guid(&#x27;io-multi-response-form-&#x27;),
        f = Y.Node.create(&#x27;&lt;form id=&quot;&#x27; + id + &#x27;&quot; name=&quot;&#x27; + id + &#x27;&quot; /&gt;&#x27;);
        f._node.style.position = &#x27;absolute&#x27;;
        f._node.style.top = &#x27;-1000px&#x27;;
        f._node.style.left = &#x27;-1000px&#x27;;

    Y.one(&#x27;body&#x27;).appendChild(f);
    return id;
}

Y.mix(Y.IO.prototype, {
    /**
     * Adds JSON encoded data to the form.
     * 
     * @method _addJSON
     * @private
     * @static
     * @param {object} f HTML form object.
     * @param {string|object} s The JSON data or object to serialize.
     * @return {array} created fields.
     */
    _addJSON: function(f, s) {
        if (!Y.Lang.isString(s)) {
            s = Y.JSON.stringify(s);
        }

        var el  = d.createElement(&#x27;input&#x27;);
        el.type = &#x27;hidden&#x27;;
        el.name = &#x27;json&#x27;;
        el.value = s;
        f.appendChild(el);
        Y.log(&#x27;key: json and value: &#x27; + s + &#x27; added as form data.&#x27;, &#x27;info&#x27;, &#x27;io&#x27;);

        return el;
    },

    /**
     * Sets the appropriate attributes and values to the HTML form, in
     * preparation of a file upload transaction.
     * 
     * @method _multi_setAttrs
     * @private
     * @static
     * @param {object} f HTML form object.
     * @param {object} id The Transaction ID.
     * @param {object} uri Qualified path to transaction resource.
     * @param {string} method POST or GET.
     * @return {void}
     */
    _multi_setAttrs: function(f, id, uri, method) {
        f.setAttribute(&#x27;action&#x27;, uri);
        f.setAttribute(&#x27;method&#x27;, method || &#x27;POST&#x27;);
        f.setAttribute(&#x27;target&#x27;, &#x27;io-multi-response-&#x27; + id );
        f.setAttribute(Y.UA.ie &amp;&amp; !_std ? &#x27;encoding&#x27; : &#x27;enctype&#x27;, &#x27;multipart/form-data&#x27;);
    },

    /**
     * Starts timeout count if the configuration object has a defined
     * timeout property.
     *
     * @method _multi_startTimeout
     * @private
     * @static
     * @param {object} o Transaction object generated by _iframe().
     * @param {object} c Configuration object passed to YUI.io().
     * @return {void}
     */
    _multi_startTimeout: function(o, c) {
        var io = this;

        io._timeout[o.id] = w.setTimeout(
            function() {
                o.status = 0;
                o.statusText = &#x27;timeout&#x27;;
                io.end(o, c);
                Y.log(&#x27;Transaction &#x27; + o.id + &#x27; timeout.&#x27;, &#x27;info&#x27;, &#x27;io&#x27;);
            }, c.timeout);
    },

    // reuse _clearTimeout()

    /**
     * Destroy the iframe and temp form, if any.
     * 
     * @method _multi_destroy
     * @private
     * @static
     * @param {number} id Transaction id.
     * @param {object} c Configuration object for the transaction.
     * @return {void}
     */
    _multi_destroy: function(id, c) {
        if (!c.debug) {
            Y.Event.purgeElement(&#x27;#io-multi-response-&#x27; + id, false);
            Y.one(&#x27;body&#x27;).removeChild(Y.one(&#x27;#io-multi-response-&#x27; + id));
            Y.log(&#x27;The iframe for transaction &#x27; + id + &#x27; has been destroyed.&#x27;, &#x27;info&#x27;, &#x27;io&#x27;);
        }

        if (c.form.id.indexOf(&#x27;io-multi-response-form-&#x27;) === 0) {
            Y.one(&#x27;body&#x27;).removeChild(Y.one(&#x27;#&#x27; + c.form.id));
            Y.log(&#x27;The temporary form for transaction &#x27; + id + &#x27; has been destroyed.&#x27;, &#x27;info&#x27;, &#x27;io&#x27;);
        }
    },

    /**
     * Bound to the iframe&#x27;s Load event and processes the response data.
     * 
     * @method _multi_complete
     * @private
     * @static
     * @param {o} o The transaction object
     * @param {object} c Configuration object for the transaction.
     * @return {void}
     */
    _multi_complete: function(o, c) {
        var io = this;

        if (c.timeout) {
            io._clearTimeout(o.id);
        }

        io.end(o, c);
        // The transaction is complete, so call _multi_destroy to remove
        // the event listener bound to the iframe, and then
        // destroy the iframe.
        w.setTimeout( function() { io._multi_destroy(o.id, c); }, 0);
    },

    /**
     * Uploads HTML form data, inclusive of files/attachments, using the
     * iframe created in _iframe to facilitate the transaction.
     * 
     * @method _multi_send
     * @private
     * @static
     * @param {o} o The transaction object
     * @param {object} uri Qualified path to transaction resource.
     * @param {object} c Configuration object for the transaction.
     * @return {void}
     */
    _multi_send: function(o, uri, c) {
        var io = this,
            f = (typeof c.form.id === &#x27;string&#x27;) ? d.getElementById(c.form.id) : c.form.id,
            // Track original HTML form attribute values.
            attr = {
                method: f.getAttribute(&#x27;method&#x27;),
                action: f.getAttribute(&#x27;action&#x27;),
                target: f.getAttribute(&#x27;target&#x27;)
            },
            fields = [];

        // Initialize the HTML form properties in case they are
        // not defined in the HTML form.
        io._multi_setAttrs(f, o.id, uri, c.method);
        if (c.data) {
            fields = io._addData(f, c.data);
        }
        if (c.json) {
            fields.push(io._addJSON(f, c.json));
        }

        // Start polling if a callback is present and the timeout
        // property has been defined.
        if (c.timeout) {
            io._multi_startTimeout(o, c);
            Y.log(&#x27;Transaction timeout started for transaction &#x27; + o.id + &#x27;.&#x27;, &#x27;info&#x27;, &#x27;io&#x27;);
        }

        // Start file upload.
        f.submit();
        io.start(o, c);
        if (c.data) {
            io._removeData(f, fields);
        }
        // Restore HTML form attributes to their original values.
        io._resetAttrs(f, attr);

        return {
            id: o.id,
            abort: function() {
                o.status = 0;
                o.statusText = &#x27;abort&#x27;;
                if (Y.one(&#x27;#io-multi-response-&#x27; + o.id)) {
                    io._multi_destroy(o.id, c);
                    io.end(o, c);
                    Y.log(&#x27;Transaction &#x27; + o.id + &#x27; aborted.&#x27;, &#x27;info&#x27;, &#x27;io&#x27;);
                }
                else {
                    Y.log(&#x27;Attempted to abort transaction &#x27; + o.id + &#x27; but transaction has completed.&#x27;, &#x27;warn&#x27;, &#x27;io&#x27;);
                    return false;
                }
            },
            isInProgress: function() {
                return Y.one(&#x27;#io-multi-response-&#x27; + o.id) ? true : false;
            },
            io: io
        };
    }
});

var orig_init = Y.IO.prototype._init;

Y.IO.prototype._init = function(c) {
    orig_init.apply(this, arguments);

    this.publish(&#x27;io:response&#x27;, Y.merge({ broadcast: 1 }, c));
    this.publish(&#x27;io-trn:response&#x27;, c);
};

var orig_upload = Y.IO.prototype.upload;

/* @param {object} o - transaction object.
 * @param {string} uri - qualified path to transaction resource.
 * @param {object} c - configuration object for the transaction.
 * @return object
 */
Y.IO.prototype.upload = function(o, uri, c) {
    if (!c.multiresponse) {
        return orig_upload.apply(this, arguments);
    }

    var io = this;
    YUI.Env.io_multi_response_callback[ o.id ] = function(data) {
        if (!data) {
            Y.error(&#x27;Callback &#x27; + o.id + &#x27; invoked without data.&#x27;, null, &#x27;io&#x27;);
            return;
        }

        // reset timeout
        if (c.timeout) {
            io._clearTimeout(o.id);
            io._multi_startTimeout(o, c);
        }

        if (c.on &amp;&amp; c.on.response) {
            o.c = data;
            io._evt(&#x27;response&#x27;, o, c);
        }
    };

    var callback_value = encodeURIComponent(&#x27;window.parent.YUI.Env.io_multi_response_callback[&#x27; + o.id + &#x27;]&#x27;);
    var callback_arg   = &#x27;callback=&#x27; + callback_value;
    if (!c.data) {
        c.data = callback_arg;
    }
    else if (L.isObject(c.data)) {
        c.data.callback = callback_value;
    }
    else {
        c.data = c.data + &#x27;&amp;&#x27; + callback_arg;
    }

    if (c.form &amp;&amp; !c.form.id) {
        delete c.form;
    }

    _iframe(o, c, io);
    return io._multi_send(o, uri, c);
};

if (!YUI.Env.io_multi_response_callback)
{
    YUI.Env.io_multi_response_callback = [];
}

var orig_io = Y.io;

/* @param {string} uri - qualified path to transaction resource.
 * @param {object} c - configuration object for the transaction.
 * @return object
 */
Y.io = function(uri, c) {
    if (c.multiresponse &amp;&amp; !c.form) {
        c.form = {
            id:     _form(c),
            upload: true
        };
    }
    else if (c.multiresponse &amp;&amp; !c.form.upload) {
        c.form.upload = true;
    }

    return orig_io.call(this, uri, c);
};

Y.mix(Y.io, orig_io);

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
