<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>&#x2F;Users&#x2F;lindalj&#x2F;open-source&#x2F;yui3&#x2F;yui3-gallery&#x2F;src&#x2F;gallery-exprbuilder&#x2F;js&#x2F;ExpressionBuilder.js - YUI 3 Gallery Modules</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.5.1&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.5.1&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title="YUI 3 Gallery Modules"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/Accordion.html">Accordion</a></li>
            
                <li><a href="..&#x2F;classes/ArrayList~extras.html">ArrayList~extras</a></li>
            
                <li><a href="..&#x2F;classes/Array~algorithms.html">Array~algorithms</a></li>
            
                <li><a href="..&#x2F;classes/Array~funcprog-extras.html">Array~funcprog-extras</a></li>
            
                <li><a href="..&#x2F;classes/Array~object-extras.html">Array~object-extras</a></li>
            
                <li><a href="..&#x2F;classes/Assert.html">Assert</a></li>
            
                <li><a href="..&#x2F;classes/AtLeastOneCheckboxGroup.html">AtLeastOneCheckboxGroup</a></li>
            
                <li><a href="..&#x2F;classes/AtMostOneCheckboxGroup.html">AtMostOneCheckboxGroup</a></li>
            
                <li><a href="..&#x2F;classes/BulkEditor.html">BulkEditor</a></li>
            
                <li><a href="..&#x2F;classes/Canvas.Context2d.html">Canvas.Context2d</a></li>
            
                <li><a href="..&#x2F;classes/CheckboxGroup.html">CheckboxGroup</a></li>
            
                <li><a href="..&#x2F;classes/Chipper.html">Chipper</a></li>
            
                <li><a href="..&#x2F;classes/ComplexMath.html">ComplexMath</a></li>
            
                <li><a href="..&#x2F;classes/ComplexNumber.html">ComplexNumber</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.AsyncFunction.html">DataSource.AsyncFunction</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.BulkEdit.html">DataSource.BulkEdit</a></li>
            
                <li><a href="..&#x2F;classes/DataSource.Treeble.html">DataSource.Treeble</a></li>
            
                <li><a href="..&#x2F;classes/EnableIfAnyCheckboxGroup.html">EnableIfAnyCheckboxGroup</a></li>
            
                <li><a href="..&#x2F;classes/ExpirationCache.html">ExpirationCache</a></li>
            
                <li><a href="..&#x2F;classes/ExpressionBuilder.html">ExpressionBuilder</a></li>
            
                <li><a href="..&#x2F;classes/FormManager.html">FormManager</a></li>
            
                <li><a href="..&#x2F;classes/HTMLTableBulkEditor.html">HTMLTableBulkEditor</a></li>
            
                <li><a href="..&#x2F;classes/InstanceManager.html">InstanceManager</a></li>
            
                <li><a href="..&#x2F;classes/io~multiresponse.html">io~multiresponse</a></li>
            
                <li><a href="..&#x2F;classes/Iterable.html">Iterable</a></li>
            
                <li><a href="..&#x2F;classes/LinkedList.html">LinkedList</a></li>
            
                <li><a href="..&#x2F;classes/LinkedListItem.html">LinkedListItem</a></li>
            
                <li><a href="..&#x2F;classes/LinkedListIterator.html">LinkedListIterator</a></li>
            
                <li><a href="..&#x2F;classes/Math.html">Math</a></li>
            
                <li><a href="..&#x2F;classes/MathCanvas.html">MathCanvas</a></li>
            
                <li><a href="..&#x2F;classes/MathCanvas.Parser.html">MathCanvas.Parser</a></li>
            
                <li><a href="..&#x2F;classes/MathCanvas.RectList.html">MathCanvas.RectList</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.html">MathFunction</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Arccosine.html">MathFunction.Arccosine</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Arcsine.html">MathFunction.Arcsine</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Arctangent.html">MathFunction.Arctangent</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Arctangent2.html">MathFunction.Arctangent2</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Conjugate.html">MathFunction.Conjugate</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Cosine.html">MathFunction.Cosine</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.E.html">MathFunction.E</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Exponential.html">MathFunction.Exponential</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.FunctionWithArgs.html">MathFunction.FunctionWithArgs</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.HyperbolicCosine.html">MathFunction.HyperbolicCosine</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.HyperbolicSine.html">MathFunction.HyperbolicSine</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.HyperbolicTangent.html">MathFunction.HyperbolicTangent</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.I.html">MathFunction.I</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.ImaginaryPart.html">MathFunction.ImaginaryPart</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.InverseHyperbolicCosine.html">MathFunction.InverseHyperbolicCosine</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.InverseHyperbolicSine.html">MathFunction.InverseHyperbolicSine</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.InverseHyperbolicTangent.html">MathFunction.InverseHyperbolicTangent</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Logarithm.html">MathFunction.Logarithm</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Magnitude.html">MathFunction.Magnitude</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Max.html">MathFunction.Max</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Min.html">MathFunction.Min</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.NaturalLog.html">MathFunction.NaturalLog</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Negate.html">MathFunction.Negate</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Phase.html">MathFunction.Phase</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Pi.html">MathFunction.Pi</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Product.html">MathFunction.Product</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Quotient.html">MathFunction.Quotient</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.RealPart.html">MathFunction.RealPart</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Rotate.html">MathFunction.Rotate</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Sine.html">MathFunction.Sine</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.SquareRoot.html">MathFunction.SquareRoot</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Sum.html">MathFunction.Sum</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Tangent.html">MathFunction.Tangent</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Value.html">MathFunction.Value</a></li>
            
                <li><a href="..&#x2F;classes/MathFunction.Variable.html">MathFunction.Variable</a></li>
            
                <li><a href="..&#x2F;classes/MRUCache.html">MRUCache</a></li>
            
                <li><a href="..&#x2F;classes/MultiObject.html">MultiObject</a></li>
            
                <li><a href="..&#x2F;classes/NodeList~extras2.html">NodeList~extras2</a></li>
            
                <li><a href="..&#x2F;classes/Node~dimensions.html">Node~dimensions</a></li>
            
                <li><a href="..&#x2F;classes/Node~optimizations.html">Node~optimizations</a></li>
            
                <li><a href="..&#x2F;classes/Node~scrollIntoView.html">Node~scrollIntoView</a></li>
            
                <li><a href="..&#x2F;classes/Object~extras.html">Object~extras</a></li>
            
                <li><a href="..&#x2F;classes/PageLayout.html">PageLayout</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.html">Paginator</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.CurrentPageInput.html">Paginator.ui.CurrentPageInput</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.CurrentPageReport.html">Paginator.ui.CurrentPageReport</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.FirstPageLink.html">Paginator.ui.FirstPageLink</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.ItemRangeDropdown.html">Paginator.ui.ItemRangeDropdown</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.LastPageLink.html">Paginator.ui.LastPageLink</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.NextPageLink.html">Paginator.ui.NextPageLink</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.PageLinks.html">Paginator.ui.PageLinks</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.PreviousPageLink.html">Paginator.ui.PreviousPageLink</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.RowsPerPageDropdown.html">Paginator.ui.RowsPerPageDropdown</a></li>
            
                <li><a href="..&#x2F;classes/Paginator.ui.ValidationPageLinks.html">Paginator.ui.ValidationPageLinks</a></li>
            
                <li><a href="..&#x2F;classes/Parsers.html">Parsers</a></li>
            
                <li><a href="..&#x2F;classes/Plugin.BusyOverlay.html">Plugin.BusyOverlay</a></li>
            
                <li><a href="..&#x2F;classes/Plugin.ConsoleTest.html">Plugin.ConsoleTest</a></li>
            
                <li><a href="..&#x2F;classes/Plugin.DataTableQuickEdit.html">Plugin.DataTableQuickEdit</a></li>
            
                <li><a href="..&#x2F;classes/Plugin.DataTableRowExpansion.html">Plugin.DataTableRowExpansion</a></li>
            
                <li><a href="..&#x2F;classes/Plugin.DataTableState.html">Plugin.DataTableState</a></li>
            
                <li><a href="..&#x2F;classes/Plugin.FixedSizeAccordion.html">Plugin.FixedSizeAccordion</a></li>
            
                <li><a href="..&#x2F;classes/Plugin.Neon.html">Plugin.Neon</a></li>
            
                <li><a href="..&#x2F;classes/Plugin.OverlayForm.html">Plugin.OverlayForm</a></li>
            
                <li><a href="..&#x2F;classes/Plugin.PageLayoutDataTableModule.html">Plugin.PageLayoutDataTableModule</a></li>
            
                <li><a href="..&#x2F;classes/QueryBuilder.html">QueryBuilder</a></li>
            
                <li><a href="..&#x2F;classes/QueryBuilder.Select.html">QueryBuilder.Select</a></li>
            
                <li><a href="..&#x2F;classes/QueryBuilder.String.html">QueryBuilder.String</a></li>
            
                <li><a href="..&#x2F;classes/RPC.Mojito.html">RPC.Mojito</a></li>
            
                <li><a href="..&#x2F;classes/SelectAllCheckboxGroup.html">SelectAllCheckboxGroup</a></li>
            
                <li><a href="..&#x2F;classes/Sort.html">Sort</a></li>
            
                <li><a href="..&#x2F;classes/Treeble.html">Treeble</a></li>
            
                <li><a href="..&#x2F;classes/YUI~funcprog.html">YUI~funcprog</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/gallery-accordion-horiz-vert.html">gallery-accordion-horiz-vert</a></li>
            
                <li><a href="..&#x2F;modules/gallery-algorithms.html">gallery-algorithms</a></li>
            
                <li><a href="..&#x2F;modules/gallery-anim-class.html">gallery-anim-class</a></li>
            
                <li><a href="..&#x2F;modules/gallery-bulkedit.html">gallery-bulkedit</a></li>
            
                <li><a href="..&#x2F;modules/gallery-busyoverlay.html">gallery-busyoverlay</a></li>
            
                <li><a href="..&#x2F;modules/gallery-canvas.html">gallery-canvas</a></li>
            
                <li><a href="..&#x2F;modules/gallery-checkboxgroups.html">gallery-checkboxgroups</a></li>
            
                <li><a href="..&#x2F;modules/gallery-chipper.html">gallery-chipper</a></li>
            
                <li><a href="..&#x2F;modules/gallery-complexnumber.html">gallery-complexnumber</a></li>
            
                <li><a href="..&#x2F;modules/gallery-console-test.html">gallery-console-test</a></li>
            
                <li><a href="..&#x2F;modules/gallery-datasource-async-function.html">gallery-datasource-async-function</a></li>
            
                <li><a href="..&#x2F;modules/gallery-datatable-row-expansion.html">gallery-datatable-row-expansion</a></li>
            
                <li><a href="..&#x2F;modules/gallery-datatable-state.html">gallery-datatable-state</a></li>
            
                <li><a href="..&#x2F;modules/gallery-dimensions.html">gallery-dimensions</a></li>
            
                <li><a href="..&#x2F;modules/gallery-expiration-cache.html">gallery-expiration-cache</a></li>
            
                <li><a href="..&#x2F;modules/gallery-exprbuilder.html">gallery-exprbuilder</a></li>
            
                <li><a href="..&#x2F;modules/gallery-formmgr.html">gallery-formmgr</a></li>
            
                <li><a href="..&#x2F;modules/gallery-formmgr-css-validation.html">gallery-formmgr-css-validation</a></li>
            
                <li><a href="..&#x2F;modules/gallery-formmgr-overlay-plugin.html">gallery-formmgr-overlay-plugin</a></li>
            
                <li><a href="..&#x2F;modules/gallery-funcprog.html">gallery-funcprog</a></li>
            
                <li><a href="..&#x2F;modules/gallery-instancemanager.html">gallery-instancemanager</a></li>
            
                <li><a href="..&#x2F;modules/gallery-io-multiresponse.html">gallery-io-multiresponse</a></li>
            
                <li><a href="..&#x2F;modules/gallery-iterable-extras.html">gallery-iterable-extras</a></li>
            
                <li><a href="..&#x2F;modules/gallery-layout.html">gallery-layout</a></li>
            
                <li><a href="..&#x2F;modules/gallery-layout-cols.html">gallery-layout-cols</a></li>
            
                <li><a href="..&#x2F;modules/gallery-layout-datatable.html">gallery-layout-datatable</a></li>
            
                <li><a href="..&#x2F;modules/gallery-layout-rows.html">gallery-layout-rows</a></li>
            
                <li><a href="..&#x2F;modules/gallery-linkedlist.html">gallery-linkedlist</a></li>
            
                <li><a href="..&#x2F;modules/gallery-math.html">gallery-math</a></li>
            
                <li><a href="..&#x2F;modules/gallery-mathcanvas.html">gallery-mathcanvas</a></li>
            
                <li><a href="..&#x2F;modules/gallery-mojito-rpc.html">gallery-mojito-rpc</a></li>
            
                <li><a href="..&#x2F;modules/gallery-mru-cache.html">gallery-mru-cache</a></li>
            
                <li><a href="..&#x2F;modules/gallery-multiobject.html">gallery-multiobject</a></li>
            
                <li><a href="..&#x2F;modules/gallery-neon.html">gallery-neon</a></li>
            
                <li><a href="..&#x2F;modules/gallery-node-optimizations.html">gallery-node-optimizations</a></li>
            
                <li><a href="..&#x2F;modules/gallery-nodelist-extras2.html">gallery-nodelist-extras2</a></li>
            
                <li><a href="..&#x2F;modules/gallery-object-extras.html">gallery-object-extras</a></li>
            
                <li><a href="..&#x2F;modules/gallery-paginator.html">gallery-paginator</a></li>
            
                <li><a href="..&#x2F;modules/gallery-querybuilder.html">gallery-querybuilder</a></li>
            
                <li><a href="..&#x2F;modules/gallery-quickedit.html">gallery-quickedit</a></li>
            
                <li><a href="..&#x2F;modules/gallery-scrollintoview.html">gallery-scrollintoview</a></li>
            
                <li><a href="..&#x2F;modules/gallery-sort-extras.html">gallery-sort-extras</a></li>
            
                <li><a href="..&#x2F;modules/gallery-test-extras.html">gallery-test-extras</a></li>
            
                <li><a href="..&#x2F;modules/gallery-treeble.html">gallery-treeble</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: &#x2F;Users&#x2F;lindalj&#x2F;open-source&#x2F;yui3&#x2F;yui3-gallery&#x2F;src&#x2F;gallery-exprbuilder&#x2F;js&#x2F;ExpressionBuilder.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&quot;use strict&quot;;

&#x2F;**
 * @module gallery-exprbuilder
 *&#x2F;

&#x2F;**
 * Widget which helps user to build a query expression.
 * 
 * @main gallery-exprbuilder
 * @class ExpressionBuilder
 * @extends Widget
 * @constructor
 * @param config {Object} Widget configuration
 *&#x2F;
function ExpressionBuilder(config)
{
	ExpressionBuilder.superclass.constructor.call(this, config);
}

ExpressionBuilder.NAME = &quot;exprbuilder&quot;;

ExpressionBuilder.ATTRS =
{
	&#x2F;**
	 * The id of the textarea form field.
	 * 
	 * @attribute fieldId
	 * @type {String}
	 * @default Y.guid()
	 * @writeonce
	 *&#x2F;
	fieldId:
	{
		value:     Y.guid(),
		validator: Y.Lang.isString,
		writeOnce: true
	},

	&#x2F;**
	 * The name of the textarea form field.
	 * 
	 * @attribute fieldName
	 * @type {String}
	 * @default &quot;&quot;
	 * @writeonce
	 *&#x2F;
	fieldName:
	{
		value:     &#x27;&#x27;,
		validator: Y.Lang.isString,
		writeOnce: true
	},

	&#x2F;**
	 * The FormManager to use when validating the constructed expression.
	 * 
	 * @attribute formMgr
	 * @type {Y.FormManager}
	 * @default null
	 * @writeonce
	 *&#x2F;
	formMgr:
	{
		validator: function(o) { return (!o || o instanceof Y.FormManager); },
		writeOnce: true
	},

	&#x2F;**
	 * The QueryBuilder to help the user construct the expression.  The
	 * widget must not be rendered.  For each variable type, the values of
	 * the configured operations must be the pattern to be inserted into
	 * the expression. {value} will be replaced by the value entered by the
	 * user.
	 * 
	 * @attribute queryBuilder
	 * @type {Y.QueryBuilder}
	 * @default null
	 * @writeonce
	 *&#x2F;
	queryBuilder:
	{
		validator: function(o) { return (!o || o instanceof Y.QueryBuilder); },
		writeOnce: true
	},

	&#x2F;**
	 * A map of QueryBuilder operators to objects defining
	 * {operator,pattern}.  This is needed if a variable type generates
	 * multiple values, and the values must be combined with something
	 * other than AND.
	 * 
	 * @attribute combinatorMap
	 * @type {Object}
	 * @default null
	 *&#x2F;
	combinatorMap:
	{
		validator: Y.Lang.isObject
	},

	&#x2F;**
	 * The label for the Insert Parentheses button.
	 * 
	 * @attribute parenLabel
	 * @type {String}
	 * @default &quot;()&quot;
	 * @writeonce
	 *&#x2F;
	parenLabel:
	{
		value:     &#x27;()&#x27;,
		validator: Y.Lang.isString,
		writeOnce: true
	},

	&#x2F;**
	 * The label for the AND button.
	 * 
	 * @attribute andLabel
	 * @type {String}
	 * @default &quot;AND&quot;
	 * @writeonce
	 *&#x2F;
	andLabel:
	{
		value:     &#x27;AND&#x27;,
		validator: Y.Lang.isString,
		writeOnce: true
	},

	&#x2F;**
	 * The label for the OR button.
	 * 
	 * @attribute orLabel
	 * @type {String}
	 * @default &quot;OR&quot;
	 * @writeonce
	 *&#x2F;
	orLabel:
	{
		value:     &#x27;OR&#x27;,
		validator: Y.Lang.isString,
		writeOnce: true
	},

	&#x2F;**
	 * The label for the NOT button.
	 * 
	 * @attribute notLabel
	 * @type {String}
	 * @default &quot;NOT&quot;
	 * @writeonce
	 *&#x2F;
	notLabel:
	{
		value:     &#x27;NOT&#x27;,
		validator: Y.Lang.isString,
		writeOnce: true
	},

	&#x2F;**
	 * The label for the Clear button.
	 * 
	 * @attribute clearLabel
	 * @type {String}
	 * @default &quot;Clear&quot;
	 * @writeonce
	 *&#x2F;
	clearLabel:
	{
		value:     &#x27;Clear&#x27;,
		validator: Y.Lang.isString,
		writeOnce: true
	},

	&#x2F;**
	 * The label for the Insert button.
	 * 
	 * @attribute insertLabel
	 * @type {String}
	 * @default &quot;Insert&quot;
	 * @writeonce
	 *&#x2F;
	insertLabel:
	{
		value:     &#x27;Insert&#x27;,
		validator: Y.Lang.isString,
		writeOnce: true
	},

	&#x2F;**
	 * The label for the Reset button.
	 * 
	 * @attribute resetLabel
	 * @type {String}
	 * @default &quot;Cancel&quot;
	 * @writeonce
	 *&#x2F;
	resetLabel:
	{
		value:     &#x27;Cancel&#x27;,
		validator: Y.Lang.isString,
		writeOnce: true
	},

	&#x2F;**
	 * The error message for an unclosed parenthesis. &lt;q&gt;context&lt;&#x2F;q&gt; is
	 * replaced by the portion of the expression that generated the error.
	 * 
	 * @attribute tooManyParensError
	 * @type {String}
	 * @default &#x27;The expression contains an extra closing parenthesis at &quot;{context}&quot;.&#x27;
	 *&#x2F;
	tooManyParensError:
	{
		value:     &#x27;The expression contains an extra closing parenthesis at &quot;{context}...&quot;.&#x27;,
		validator: Y.Lang.isString
	},

	&#x2F;**
	 * The error message for an unmatched single quote.
	 * 
	 * @attribute unmatchedSingleQuoteError
	 * @type {String}
	 * @default &#x27;The expression contains an unmatched single quote.&#x27;
	 *&#x2F;
	unmatchedSingleQuoteError:
	{
		value:     &#x27;The expression contains an unmatched single quote at &quot;{context}...&quot;.&#x27;,
		validator: Y.Lang.isString
	},

	&#x2F;**
	 * The error message for an unclosed parenthesis.
	 * 
	 * @attribute unclosedParenError
	 * @type {String}
	 * @default &#x27;The expression contains an unclosed parenthesis.&#x27;
	 *&#x2F;
	unclosedParenError:
	{
		value:     &#x27;The expression contains an unclosed parenthesis at &quot;{context}...&quot;.&#x27;,
		validator: Y.Lang.isString
	},

	&#x2F;**
	 * The error message when the user forgets to select a variable for
	 * insertion.
	 * 
	 * @attribute noVariableSelectedError
	 * @type {String}
	 * @default &#x27;Please choose a variable.&#x27;
	 *&#x2F;
	noVariableSelectedError:
	{
		value:     &#x27;Please choose a variable.&#x27;,
		validator: Y.Lang.isString
	}
};

function updateIERange()
{
	this.ie_range = document.selection.createRange();
}

function insertText(text, offset)
{
	offset = offset || text.length;

	this.field.focus();
	var el = Y.Node.getDOMNode(this.field);

	if (el.setSelectionRange)		&#x2F;&#x2F; For Mozilla&#x2F;WebKit
	{
		var start = el.selectionStart;
		el.value =
			el.value.substring(0, start) +
			text +
			el.value.substring(el.selectionEnd, el.value.length);

		var index = start + offset;
		el.setSelectionRange(index, index);
	}
	else if (document.selection)	&#x2F;&#x2F; For IE
	{
		if (!this.ie_range)
		{
			this.ie_range = document.selection.createRange();
		}

		var r  = this.ie_range.duplicate();
		r.text = text;

		this.ie_range.move(&#x27;character&#x27;, offset);
		this.ie_range.select();
	}
}

function paren(e)
{
	insertText.call(this, &#x27;()&#x27;, 1);
	e.halt();
}

function handler(key)
{
	return function(e)
	{
		insertText.call(this, &#x27; &#x27; + this.get(key+&#x27;Label&#x27;) + &#x27; &#x27;);
		e.halt();
	};
}

function clear(e)
{
	this.clear();
	e.halt();
}

function insertQB(e)
{
	var qb = this.get(&#x27;queryBuilder&#x27;);
	if (!qb.validateFields())
	{
		e.halt();
		return;
	}

	var query = qb.toDatabaseQuery();
	if (query.length === 0)
	{
		var el = qb.get(&#x27;contentBox&#x27;).one(&#x27;select&#x27;);
		qb.displayFieldMessage(el, this.get(&#x27;noVariableSelectedError&#x27;), &#x27;error&#x27;);
		e.halt();
		return;
	}

	var map = this.get(&#x27;combinatorMap&#x27;);

	var s     = &#x27;&#x27;;
	var op    = &#x27; &#x27; + this.get(&#x27;andLabel&#x27;) + &#x27; &#x27;;
	for (var i=0; i&lt;query.length; i++)
	{
		var q = query[i];

		if (i &gt; 0)
		{
			s += op;
		}
		s += q[0];

		var pattern = q[1];
		if (pattern.indexOf(&#x27;{&#x27;) == -1)
		{
			pattern += &#x27;{value}&#x27;;
		}

		var combinator = map &amp;&amp; map[ q[1] ];
		if (combinator)
		{
			op      = combinator.operator;
			pattern = combinator.pattern;
		}

		s += Y.Lang.substitute(pattern,
		{
			value: q[2].replace(&#x2F;&#x27;&#x2F;g, &#x27;\\\&#x27;&#x27;)
		});
	}

	insertText.call(this, s);
	qb.reset();
	e.halt();
}

function resetQB(e)
{
	this.get(&#x27;queryBuilder&#x27;).reset();

	if (e)
	{
		e.halt();
	}
}

function setValidation(f)
{
	if (f)
	{
		var self = this;

		var orig_validateForm = f.validateForm;
		f.validateForm = function()
		{
			resetQB.call(self);
			orig_validateForm.apply(this, arguments);
		};

		f.setFunction(this.get(&#x27;fieldId&#x27;), function(form, e)
		{
			return self._validateExpression(form, e, this);
		});
	}
}

Y.extend(ExpressionBuilder, Y.Widget,
{
	initializer: function(config)
	{
		&#x2F;&#x2F; FormManager

		setValidation.call(this, config.formMgr);
		this.after(&#x27;formMgrChange&#x27;, function(e)
		{
			if (e.prevVal)
			{
				e.prevVal.setFunction(this.get(&#x27;fieldId&#x27;), null);
			}

			setValidation.call(this, e.newVal);
		});
	},

	renderUI: function()
	{
		var container = this.get(&#x27;contentBox&#x27;);
		container.set(&#x27;innerHTML&#x27;, this._field());

		&#x2F;&#x2F; textarea

		this.field = container.one(&#x27;#&#x27;+this.get(&#x27;fieldId&#x27;));

		if (document.selection)
		{
			this.field.on(&#x27;change&#x27;, updateIERange, this);
		}

		&#x2F;&#x2F; basic controls

		container.one(&#x27;.&#x27;+this.getClassName(&#x27;paren&#x27;)).on(&#x27;click&#x27;, paren, this);

		var op = [ &#x27;and&#x27;, &#x27;or&#x27;, &#x27;not&#x27; ];
		for (var i=0; i&lt;op.length; i++)
		{
			container.one(&#x27;.&#x27;+this.getClassName(op[i])).on(&#x27;click&#x27;, handler(op[i]), this);
		}

		container.one(&#x27;.&#x27;+this.getClassName(&#x27;clear&#x27;)).on(&#x27;click&#x27;, clear, this);

		&#x2F;&#x2F; QueryBuilder

		var qb = this.get(&#x27;queryBuilder&#x27;);
		if (qb)
		{
			container.appendChild(Y.Node.create(this._query()));

			qb.render(container.one(&#x27;.&#x27;+this.getClassName(&#x27;querybuilder&#x27;)));

			container.one(&#x27;.&#x27;+this.getClassName(&#x27;insert&#x27;)).on(&#x27;click&#x27;, insertQB, this);
			container.one(&#x27;.&#x27;+this.getClassName(&#x27;reset&#x27;)).on(&#x27;click&#x27;, resetQB, this);
		}
	},

	destructor: function()
	{
		var qb = this.get(&#x27;queryBuilder&#x27;);
		if (qb)
		{
			qb.destroy();
		}

		this.ie_range = null;
	},

	&#x2F;**
	 * Clears the expression.
	 * 
	 * @method clear
	 *&#x2F;
	clear: function()
	{
		this.field.set(&#x27;value&#x27;, &#x27;&#x27;);
		this.field.focus();
	},

	&#x2F;**
	 * Validate the expression.
	 * 
	 * @method _validateExpression
	 * @protected
	 * @return {Boolean} &lt;code&gt;true&lt;&#x2F;code&gt; if the expression has balanced parens and single quotes
	 *&#x2F;
	_validateExpression: function(form, e, form_mgr)
	{
		var s     = e.get(&#x27;value&#x27;);
		var paren = 0;
		var pi    = -1;
		var quote = false;
		var qi    = -1;
		for (var i=0; i&lt;s.length; i++)
		{
			var c = s.charAt(i);
			if (!quote &amp;&amp; c == &#x27;(&#x27;)
			{
				if (paren === 0)
				{
					pi = i;
				}
				paren++;
			}
			else if (!quote &amp;&amp; c == &#x27;)&#x27;)
			{
				paren--;
				if (paren &lt; 0)
				{
					var msg = Y.Lang.substitute(this.get(&#x27;tooManyParensError&#x27;),
					{
						context: s.substr(0,i+1)
					});
					form_mgr.displayMessage(e, msg, &#x27;error&#x27;);
					return false;
				}
			}
			else if (c == &#x27;\&#x27;&#x27; &amp;&amp; (i === 0 || s.charAt(i-1) != &#x27;\\&#x27;))
			{
				if (!quote)
				{
					qi = i;
				}
				quote = ! quote;
			}
		}

		if (quote &amp;&amp; (paren === 0 || qi &lt; pi))
		{
			var msg = Y.Lang.substitute(this.get(&#x27;unmatchedSingleQuoteError&#x27;),
			{
				context: s.substr(0,qi+1)
			});
			form_mgr.displayMessage(e, msg, &#x27;error&#x27;);
			return false;
		}
		else if (paren &gt; 0)
		{
			var msg = Y.Lang.substitute(this.get(&#x27;unclosedParenError&#x27;),
			{
				context: s.substr(0,pi+1)
			});
			form_mgr.displayMessage(e, msg, &#x27;error&#x27;);
			return false;
		}

		return true;
	},

	&#x2F;&#x2F;
	&#x2F;&#x2F; Markup
	&#x2F;&#x2F;

	&#x2F;**
	 * @method _field
	 * @protected
	 * @return {String} markup for the textarea and basic buttons
	 *&#x2F;
	_field: function()
	{
		var markup =
			&#x27;&lt;div class=&quot;{td}&quot;&gt;&#x27; +
				&#x27;&lt;textarea id=&quot;{tid}&quot; name=&quot;{tn}&quot; class=&quot;{ff} {ta}&quot;&gt;&lt;&#x2F;textarea&gt;&#x27; +
			&#x27;&lt;&#x2F;div&gt;&#x27; +
			&#x27;&lt;div class=&quot;{fctl}&quot;&gt;&#x27; +
				&#x27;&lt;button class=&quot;{pc}&quot;&gt;{paren}&lt;&#x2F;button&gt;&#x27; +
				&#x27;&lt;button class=&quot;{ac}&quot;&gt;{and}&lt;&#x2F;button&gt;&#x27; +
				&#x27;&lt;button class=&quot;{oc}&quot;&gt;{or}&lt;&#x2F;button&gt;&#x27; +
				&#x27;&lt;button class=&quot;{nc}&quot;&gt;{not}&lt;&#x2F;button&gt;&#x27; +
				&#x27;&lt;button class=&quot;{cc}&quot;&gt;{clear}&lt;&#x2F;button&gt;&#x27; +
			&#x27;&lt;&#x2F;div&gt;&#x27;;

		return Y.Lang.substitute(markup,
		{
			td:     this.getClassName(&#x27;field-container&#x27;),
			ff:     Y.FormManager.field_marker_class,
			ta:     this.getClassName(&#x27;field&#x27;),
			tid:    this.get(&#x27;fieldId&#x27;),
			tn:     this.get(&#x27;fieldName&#x27;),
			fctl:   this.getClassName(&#x27;controls&#x27;),
			pc:     this.getClassName(&#x27;paren&#x27;),
			ac:     this.getClassName(&#x27;and&#x27;),
			oc:     this.getClassName(&#x27;or&#x27;),
			nc:     this.getClassName(&#x27;not&#x27;),
			cc:     this.getClassName(&#x27;clear&#x27;),
			paren:  this.get(&#x27;parenLabel&#x27;),
			and:    this.get(&#x27;andLabel&#x27;),
			or:     this.get(&#x27;orLabel&#x27;),
			not:    this.get(&#x27;notLabel&#x27;),
			clear:  this.get(&#x27;clearLabel&#x27;)
		});
	},

	&#x2F;**
	 * @method _query
	 * @protected
	 * @return {String} markup for the QueryBuilder
	 *&#x2F;
	_query: function()
	{
		var markup =
			&#x27;&lt;div class=&quot;{qb}&quot;&gt;&lt;&#x2F;div&gt;&#x27; +
			&#x27;&lt;div class=&quot;{qbctl} {fr}&quot;&gt;&#x27; +
				&#x27;&lt;button class=&quot;{ic}&quot;&gt;{insert}&lt;&#x2F;button&gt;&#x27; +
				&#x27;&lt;button class=&quot;{rc}&quot;&gt;{reset}&lt;&#x2F;button&gt;&#x27; +
			&#x27;&lt;&#x2F;div&gt;&#x27;;

		return Y.Lang.substitute(markup,
		{
			qb:     this.getClassName(&#x27;querybuilder&#x27;),
			qbctl:  this.getClassName(&#x27;querybuilder-controls&#x27;),
			fr:     Y.FormManager.row_marker_class,
			ic:     this.getClassName(&#x27;insert&#x27;),
			rc:     this.getClassName(&#x27;reset&#x27;),
			insert: this.get(&#x27;insertLabel&#x27;),
			reset:  this.get(&#x27;resetLabel&#x27;)
		});
	}
});

Y.ExpressionBuilder = ExpressionBuilder;

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
