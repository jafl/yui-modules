<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/gallery-layout/js/PageLayout.js - YUI 3 Gallery Modules</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="YUI 3 Gallery Modules" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Accordion.html">Accordion</a></li>
                                <li><a href="../classes/AnimSequence.html">AnimSequence</a></li>
                                <li><a href="../classes/ArrayIterator.html">ArrayIterator</a></li>
                                <li><a href="../classes/ArrayList~extras.html">ArrayList~extras</a></li>
                                <li><a href="../classes/Array~algorithms.html">Array~algorithms</a></li>
                                <li><a href="../classes/Array~funcprog-extras.html">Array~funcprog-extras</a></li>
                                <li><a href="../classes/Array~object-extras.html">Array~object-extras</a></li>
                                <li><a href="../classes/Assert.html">Assert</a></li>
                                <li><a href="../classes/AtLeastOneCheckboxGroup.html">AtLeastOneCheckboxGroup</a></li>
                                <li><a href="../classes/AtMostOneCheckboxGroup.html">AtMostOneCheckboxGroup</a></li>
                                <li><a href="../classes/BulkEditor.html">BulkEditor</a></li>
                                <li><a href="../classes/Canvas.Context2d.html">Canvas.Context2d</a></li>
                                <li><a href="../classes/CheckboxGroup.html">CheckboxGroup</a></li>
                                <li><a href="../classes/Chipper.html">Chipper</a></li>
                                <li><a href="../classes/CollapseToggle.html">CollapseToggle</a></li>
                                <li><a href="../classes/ComplexMath.html">ComplexMath</a></li>
                                <li><a href="../classes/ComplexNumber.html">ComplexNumber</a></li>
                                <li><a href="../classes/DataSource.AsyncFunction.html">DataSource.AsyncFunction</a></li>
                                <li><a href="../classes/DataSource.BulkEdit.html">DataSource.BulkEdit</a></li>
                                <li><a href="../classes/DataSource.Treeble.html">DataSource.Treeble</a></li>
                                <li><a href="../classes/DateTime.html">DateTime</a></li>
                                <li><a href="../classes/DateTimeRange.html">DateTimeRange</a></li>
                                <li><a href="../classes/DateTimeUtils.html">DateTimeUtils</a></li>
                                <li><a href="../classes/EnableIfAnyCheckboxGroup.html">EnableIfAnyCheckboxGroup</a></li>
                                <li><a href="../classes/ExpirationCache.html">ExpirationCache</a></li>
                                <li><a href="../classes/ExpressionBuilder.html">ExpressionBuilder</a></li>
                                <li><a href="../classes/FormManager.html">FormManager</a></li>
                                <li><a href="../classes/HTMLTableBulkEditor.html">HTMLTableBulkEditor</a></li>
                                <li><a href="../classes/InputPopup.html">InputPopup</a></li>
                                <li><a href="../classes/InstanceManager.html">InstanceManager</a></li>
                                <li><a href="../classes/io~multiresponse.html">io~multiresponse</a></li>
                                <li><a href="../classes/Iterable.html">Iterable</a></li>
                                <li><a href="../classes/LinkedList.html">LinkedList</a></li>
                                <li><a href="../classes/LinkedListItem.html">LinkedListItem</a></li>
                                <li><a href="../classes/LinkedListIterator.html">LinkedListIterator</a></li>
                                <li><a href="../classes/LogFilter.html">LogFilter</a></li>
                                <li><a href="../classes/Math.html">Math</a></li>
                                <li><a href="../classes/MathCanvas.html">MathCanvas</a></li>
                                <li><a href="../classes/MathCanvas.Parser.html">MathCanvas.Parser</a></li>
                                <li><a href="../classes/MathCanvas.RectList.html">MathCanvas.RectList</a></li>
                                <li><a href="../classes/MathFunction.html">MathFunction</a></li>
                                <li><a href="../classes/MathFunction.Arccosine.html">MathFunction.Arccosine</a></li>
                                <li><a href="../classes/MathFunction.Arcsine.html">MathFunction.Arcsine</a></li>
                                <li><a href="../classes/MathFunction.Arctangent.html">MathFunction.Arctangent</a></li>
                                <li><a href="../classes/MathFunction.Arctangent2.html">MathFunction.Arctangent2</a></li>
                                <li><a href="../classes/MathFunction.Conjugate.html">MathFunction.Conjugate</a></li>
                                <li><a href="../classes/MathFunction.Cosine.html">MathFunction.Cosine</a></li>
                                <li><a href="../classes/MathFunction.E.html">MathFunction.E</a></li>
                                <li><a href="../classes/MathFunction.Exponential.html">MathFunction.Exponential</a></li>
                                <li><a href="../classes/MathFunction.FunctionWithArgs.html">MathFunction.FunctionWithArgs</a></li>
                                <li><a href="../classes/MathFunction.HyperbolicCosine.html">MathFunction.HyperbolicCosine</a></li>
                                <li><a href="../classes/MathFunction.HyperbolicSine.html">MathFunction.HyperbolicSine</a></li>
                                <li><a href="../classes/MathFunction.HyperbolicTangent.html">MathFunction.HyperbolicTangent</a></li>
                                <li><a href="../classes/MathFunction.I.html">MathFunction.I</a></li>
                                <li><a href="../classes/MathFunction.ImaginaryPart.html">MathFunction.ImaginaryPart</a></li>
                                <li><a href="../classes/MathFunction.Input.html">MathFunction.Input</a></li>
                                <li><a href="../classes/MathFunction.InverseHyperbolicCosine.html">MathFunction.InverseHyperbolicCosine</a></li>
                                <li><a href="../classes/MathFunction.InverseHyperbolicSine.html">MathFunction.InverseHyperbolicSine</a></li>
                                <li><a href="../classes/MathFunction.InverseHyperbolicTangent.html">MathFunction.InverseHyperbolicTangent</a></li>
                                <li><a href="../classes/MathFunction.Logarithm.html">MathFunction.Logarithm</a></li>
                                <li><a href="../classes/MathFunction.Magnitude.html">MathFunction.Magnitude</a></li>
                                <li><a href="../classes/MathFunction.Max.html">MathFunction.Max</a></li>
                                <li><a href="../classes/MathFunction.Min.html">MathFunction.Min</a></li>
                                <li><a href="../classes/MathFunction.NaturalLog.html">MathFunction.NaturalLog</a></li>
                                <li><a href="../classes/MathFunction.Negate.html">MathFunction.Negate</a></li>
                                <li><a href="../classes/MathFunction.Phase.html">MathFunction.Phase</a></li>
                                <li><a href="../classes/MathFunction.Pi.html">MathFunction.Pi</a></li>
                                <li><a href="../classes/MathFunction.Product.html">MathFunction.Product</a></li>
                                <li><a href="../classes/MathFunction.Quotient.html">MathFunction.Quotient</a></li>
                                <li><a href="../classes/MathFunction.RealPart.html">MathFunction.RealPart</a></li>
                                <li><a href="../classes/MathFunction.Rotate.html">MathFunction.Rotate</a></li>
                                <li><a href="../classes/MathFunction.Sine.html">MathFunction.Sine</a></li>
                                <li><a href="../classes/MathFunction.SquareRoot.html">MathFunction.SquareRoot</a></li>
                                <li><a href="../classes/MathFunction.Sum.html">MathFunction.Sum</a></li>
                                <li><a href="../classes/MathFunction.Tangent.html">MathFunction.Tangent</a></li>
                                <li><a href="../classes/MathFunction.Value.html">MathFunction.Value</a></li>
                                <li><a href="../classes/MathFunction.Variable.html">MathFunction.Variable</a></li>
                                <li><a href="../classes/MatrixBackground.html">MatrixBackground</a></li>
                                <li><a href="../classes/MatrixCredits.html">MatrixCredits</a></li>
                                <li><a href="../classes/MRUCache.html">MRUCache</a></li>
                                <li><a href="../classes/MultiObject.html">MultiObject</a></li>
                                <li><a href="../classes/NodeList~extras2.html">NodeList~extras2</a></li>
                                <li><a href="../classes/Node~dimensions.html">Node~dimensions</a></li>
                                <li><a href="../classes/Node~event-set.html">Node~event-set</a></li>
                                <li><a href="../classes/Node~optimizations.html">Node~optimizations</a></li>
                                <li><a href="../classes/Node~scrollIntoView.html">Node~scrollIntoView</a></li>
                                <li><a href="../classes/Node~utils.html">Node~utils</a></li>
                                <li><a href="../classes/Object~extras.html">Object~extras</a></li>
                                <li><a href="../classes/PageLayout.html">PageLayout</a></li>
                                <li><a href="../classes/Paginator.ui.CurrentPageInput.html">Paginator.ui.CurrentPageInput</a></li>
                                <li><a href="../classes/Paginator.ui.CurrentPageReport.html">Paginator.ui.CurrentPageReport</a></li>
                                <li><a href="../classes/Paginator.ui.FirstPageLink.html">Paginator.ui.FirstPageLink</a></li>
                                <li><a href="../classes/Paginator.ui.ItemRangeDropdown.html">Paginator.ui.ItemRangeDropdown</a></li>
                                <li><a href="../classes/Paginator.ui.LastPageLink.html">Paginator.ui.LastPageLink</a></li>
                                <li><a href="../classes/Paginator.ui.NextPageLink.html">Paginator.ui.NextPageLink</a></li>
                                <li><a href="../classes/Paginator.ui.PageLinks.html">Paginator.ui.PageLinks</a></li>
                                <li><a href="../classes/Paginator.ui.PreviousPageLink.html">Paginator.ui.PreviousPageLink</a></li>
                                <li><a href="../classes/Paginator.ui.RowsPerPageDropdown.html">Paginator.ui.RowsPerPageDropdown</a></li>
                                <li><a href="../classes/Paginator.ui.ValidationPageLinks.html">Paginator.ui.ValidationPageLinks</a></li>
                                <li><a href="../classes/Parsers.html">Parsers</a></li>
                                <li><a href="../classes/Plugin.BusyOverlay.html">Plugin.BusyOverlay</a></li>
                                <li><a href="../classes/Plugin.ConsoleTest.html">Plugin.ConsoleTest</a></li>
                                <li><a href="../classes/Plugin.DataTableDataSourceBusy.html">Plugin.DataTableDataSourceBusy</a></li>
                                <li><a href="../classes/Plugin.DataTablePaginator.html">Plugin.DataTablePaginator</a></li>
                                <li><a href="../classes/Plugin.DataTableQuickEdit.html">Plugin.DataTableQuickEdit</a></li>
                                <li><a href="../classes/Plugin.DataTableRowExpansion.html">Plugin.DataTableRowExpansion</a></li>
                                <li><a href="../classes/Plugin.DataTableState.html">Plugin.DataTableState</a></li>
                                <li><a href="../classes/Plugin.FixedSizeAccordion.html">Plugin.FixedSizeAccordion</a></li>
                                <li><a href="../classes/Plugin.InputCalendarSync.html">Plugin.InputCalendarSync</a></li>
                                <li><a href="../classes/Plugin.Neon.html">Plugin.Neon</a></li>
                                <li><a href="../classes/Plugin.NodeFXSequence.html">Plugin.NodeFXSequence</a></li>
                                <li><a href="../classes/Plugin.OverlayForm.html">Plugin.OverlayForm</a></li>
                                <li><a href="../classes/Plugin.PageLayoutAnyWidgetModule.html">Plugin.PageLayoutAnyWidgetModule</a></li>
                                <li><a href="../classes/Plugin.PageLayoutDataTableModule.html">Plugin.PageLayoutDataTableModule</a></li>
                                <li><a href="../classes/Popup.html">Popup</a></li>
                                <li><a href="../classes/QueryBuilder.html">QueryBuilder</a></li>
                                <li><a href="../classes/QueryBuilder.DateRange.html">QueryBuilder.DateRange</a></li>
                                <li><a href="../classes/QueryBuilder.MultiselectInput.html">QueryBuilder.MultiselectInput</a></li>
                                <li><a href="../classes/QueryBuilder.Select.html">QueryBuilder.Select</a></li>
                                <li><a href="../classes/QueryBuilder.String.html">QueryBuilder.String</a></li>
                                <li><a href="../classes/RPC.Mojito.html">RPC.Mojito</a></li>
                                <li><a href="../classes/SelectAllCheckboxGroup.html">SelectAllCheckboxGroup</a></li>
                                <li><a href="../classes/Sort.html">Sort</a></li>
                                <li><a href="../classes/Treeble.html">Treeble</a></li>
                                <li><a href="../classes/YUI~funcprog.html">YUI~funcprog</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/gallery-accordion-horiz-vert.html">gallery-accordion-horiz-vert</a></li>
                                <li><a href="../modules/gallery-adobe-air-config.html">gallery-adobe-air-config</a></li>
                                <li><a href="../modules/gallery-adobe-air-page-manager.html">gallery-adobe-air-page-manager</a></li>
                                <li><a href="../modules/gallery-adobe-air-prefs.html">gallery-adobe-air-prefs</a></li>
                                <li><a href="../modules/gallery-algorithms.html">gallery-algorithms</a></li>
                                <li><a href="../modules/gallery-anim-class.html">gallery-anim-class</a></li>
                                <li><a href="../modules/gallery-anim-sequence.html">gallery-anim-sequence</a></li>
                                <li><a href="../modules/gallery-bulkedit.html">gallery-bulkedit</a></li>
                                <li><a href="../modules/gallery-busyoverlay.html">gallery-busyoverlay</a></li>
                                <li><a href="../modules/gallery-canvas.html">gallery-canvas</a></li>
                                <li><a href="../modules/gallery-checkboxgroups.html">gallery-checkboxgroups</a></li>
                                <li><a href="../modules/gallery-chipper.html">gallery-chipper</a></li>
                                <li><a href="../modules/gallery-collapse-toggle.html">gallery-collapse-toggle</a></li>
                                <li><a href="../modules/gallery-complexnumber.html">gallery-complexnumber</a></li>
                                <li><a href="../modules/gallery-console-test.html">gallery-console-test</a></li>
                                <li><a href="../modules/gallery-datasource-async-function.html">gallery-datasource-async-function</a></li>
                                <li><a href="../modules/gallery-datatable-datasource-busy.html">gallery-datatable-datasource-busy</a></li>
                                <li><a href="../modules/gallery-datatable-paginator.html">gallery-datatable-paginator</a></li>
                                <li><a href="../modules/gallery-datatable-row-expansion.html">gallery-datatable-row-expansion</a></li>
                                <li><a href="../modules/gallery-datatable-state.html">gallery-datatable-state</a></li>
                                <li><a href="../modules/gallery-datetime.html">gallery-datetime</a></li>
                                <li><a href="../modules/gallery-datetime-range.html">gallery-datetime-range</a></li>
                                <li><a href="../modules/gallery-datetime-utils.html">gallery-datetime-utils</a></li>
                                <li><a href="../modules/gallery-dimensions.html">gallery-dimensions</a></li>
                                <li><a href="../modules/gallery-expiration-cache.html">gallery-expiration-cache</a></li>
                                <li><a href="../modules/gallery-exprbuilder.html">gallery-exprbuilder</a></li>
                                <li><a href="../modules/gallery-formmgr.html">gallery-formmgr</a></li>
                                <li><a href="../modules/gallery-formmgr-css-validation.html">gallery-formmgr-css-validation</a></li>
                                <li><a href="../modules/gallery-formmgr-overlay-plugin.html">gallery-formmgr-overlay-plugin</a></li>
                                <li><a href="../modules/gallery-funcprog.html">gallery-funcprog</a></li>
                                <li><a href="../modules/gallery-input-calendar-sync.html">gallery-input-calendar-sync</a></li>
                                <li><a href="../modules/gallery-instancemanager.html">gallery-instancemanager</a></li>
                                <li><a href="../modules/gallery-io-adobe-air.html">gallery-io-adobe-air</a></li>
                                <li><a href="../modules/gallery-io-multiresponse.html">gallery-io-multiresponse</a></li>
                                <li><a href="../modules/gallery-iterable-extras.html">gallery-iterable-extras</a></li>
                                <li><a href="../modules/gallery-layout.html">gallery-layout</a></li>
                                <li><a href="../modules/gallery-layout-anywidget.html">gallery-layout-anywidget</a></li>
                                <li><a href="../modules/gallery-layout-cols.html">gallery-layout-cols</a></li>
                                <li><a href="../modules/gallery-layout-datatable.html">gallery-layout-datatable</a></li>
                                <li><a href="../modules/gallery-layout-rows.html">gallery-layout-rows</a></li>
                                <li><a href="../modules/gallery-linkedlist.html">gallery-linkedlist</a></li>
                                <li><a href="../modules/gallery-log-filter.html">gallery-log-filter</a></li>
                                <li><a href="../modules/gallery-math.html">gallery-math</a></li>
                                <li><a href="../modules/gallery-mathcanvas.html">gallery-mathcanvas</a></li>
                                <li><a href="../modules/gallery-matrix-background.html">gallery-matrix-background</a></li>
                                <li><a href="../modules/gallery-matrix-credits.html">gallery-matrix-credits</a></li>
                                <li><a href="../modules/gallery-mojito-rpc.html">gallery-mojito-rpc</a></li>
                                <li><a href="../modules/gallery-mru-cache.html">gallery-mru-cache</a></li>
                                <li><a href="../modules/gallery-multiobject.html">gallery-multiobject</a></li>
                                <li><a href="../modules/gallery-neon.html">gallery-neon</a></li>
                                <li><a href="../modules/gallery-node-event-set.html">gallery-node-event-set</a></li>
                                <li><a href="../modules/gallery-node-optimizations.html">gallery-node-optimizations</a></li>
                                <li><a href="../modules/gallery-node-utils.html">gallery-node-utils</a></li>
                                <li><a href="../modules/gallery-nodelist-extras2.html">gallery-nodelist-extras2</a></li>
                                <li><a href="../modules/gallery-object-extras.html">gallery-object-extras</a></li>
                                <li><a href="../modules/gallery-paginator.html">gallery-paginator</a></li>
                                <li><a href="../modules/gallery-popup.html">gallery-popup</a></li>
                                <li><a href="../modules/gallery-querybuilder.html">gallery-querybuilder</a></li>
                                <li><a href="../modules/gallery-querybuilder-daterange.html">gallery-querybuilder-daterange</a></li>
                                <li><a href="../modules/gallery-querybuilder-multiselect-input.html">gallery-querybuilder-multiselect-input</a></li>
                                <li><a href="../modules/gallery-quickedit.html">gallery-quickedit</a></li>
                                <li><a href="../modules/gallery-scrollintoview.html">gallery-scrollintoview</a></li>
                                <li><a href="../modules/gallery-sort-extras.html">gallery-sort-extras</a></li>
                                <li><a href="../modules/gallery-table-utils.html">gallery-table-utils</a></li>
                                <li><a href="../modules/gallery-test-extras.html">gallery-test-extras</a></li>
                                <li><a href="../modules/gallery-treeble.html">gallery-treeble</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/gallery-layout/js/PageLayout.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&quot;use strict&quot;;

/**
 * Provides fluid layout for the content on a page.
 *
 * @module gallery-layout
 */

/**
 * Manages header (layout-hd), body (layout-bd), footer (layout-ft) stacked
 * vertically to either fit inside the viewport (fit-to-viewport) or adjust
 * to the size of the body content (fit-to-content).
 * 
 * The body content is sub-divided into modules, arranged either in rows or
 * columns.  The layout is automatically detected based on the marker
 * classes attached to the two layers of divs inside layout-bd:  either
 * layout-module-row &gt; layout-module or layout-module-col &gt; layout-module
 * 
 * Each module has an optional header (layout-m-hd), a body (layout-m-bd),
 * and an optional footer (layout-m-ft).  You can have multiple
 * layout-m-bd&#x27;s, but only one can be visible at a time.  If you change the
 * DOM in any way that affects the height of any module header, body, or
 * footer, or if you switch bodies, you must call &#x60;elementResized()&#x60; to
 * reflow the layout.  (Technically, you do not have to call
 * &#x60;elementResized()&#x60; if you modify a module body in fit-to-viewport mode,
 * but if you later decide to switch to fit-to-content, your optimization
 * will cause trouble.)
 * 
 * If you want a row, column, or module to have a fixed size, add the class
 * layout-not-managed to the layout-module-row, layout-module-column, or
 * layout-module.  Then use CSS to set the width of layout-module (for a
 * row) or layout-module-col (for a col), or the height of layout-m-bd.
 * 
 * If the body content is a single module, it expands as the content
 * expands (fit-to-content) until it would push the footer below the fold.
 * Then it switches to fit-to-viewport so the scrollbar appears on the
 * module instead of the entire viewport.  (If you do not want this
 * behavior in a particular case, add the class FORCE_FIT to layout-bd.)
 * 
 * Note that a non-zero margin-top on the top element or a non-zero
 * margin-bottom on the bottom element inside any container will break the
 * layout because browsers lie about the total height of the container in
 * this case.  Use padding instead of margin on elements inside headers and
 * footers.
 * 
 * If you wish to display a loading message that automatically disappears
 * after the first time the layout is calculated, add the class
 * &#x60;layout-loading&#x60; to the div containing the message.  (To be visible,
 * this div must not be inside the div with class &#x60;layout-bd&#x60;, since that
 * has &#x60;visibility:hidden&#x60;.)
 *
 * @class PageLayout
 * @extends Base
 * @constructor
 * @param config {Object}
 */

function PageLayout()
{
	PageLayout.superclass.constructor.apply(this, arguments);
}

PageLayout.NAME = &quot;pagelayout&quot;;

/**
 * @property FIT_TO_VIEWPORT
 * @static
 */
PageLayout.FIT_TO_VIEWPORT = 0;

/**
 * @property FIT_TO_CONTENT
 * @static
 */
PageLayout.FIT_TO_CONTENT = 1;

PageLayout.ATTRS =
{
	/**
	 * FIT_TO_VIEWPORT sizes the rows to fit everything inside the
	 * browser&#x27;s viewport.  FIT_TO_CONTENT sizes the rows to eliminate all
	 * scrollbars on module bodies.  Note that you can configure this
	 * property by putting the CSS class &quot;FIT_TO_VIEWPORT&quot; or
	 * &quot;FIT_TO_CONTENT&quot; on layout-bd.
	 *
	 * @attribute mode
	 * @type PageLayout.FIT_TO_VIEWPORT or PageLayout.FIT_TO_CONTENT
	 * @default PageLayout.FIT_TO_VIEWPORT
	 */
	mode:
	{
		value:     PageLayout.FIT_TO_VIEWPORT,
		validator: function(value)
		{
			return (value === PageLayout.FIT_TO_VIEWPORT || value === PageLayout.FIT_TO_CONTENT);
		}
	},

	/**
	 * Minimum page width, measured in em&#x27;s.  The page content will not
	 * collapse narrower than this width.  If the viewport is smaller, the
	 * brower&#x27;s horizontal scrollbar will appear.
	 * 
	 * @attribute minWidth
	 * @type {Number} em&#x27;s
	 * @default 73 (em) 950px @ 13px font
	 */
	minWidth:
	{
		value:     73,
		validator: function(value)
		{
			return (Y.Lang.isNumber(value) &amp;&amp; value &gt; 0);
		}
	},

	/**
	 * Minimum page height in FIT_TO_VIEWPORT mode, measured in em&#x27;s.  The
	 * page content will not collapse lower than this height.  If the
	 * viewport is smaller, the brower&#x27;s vertical scrollbar will appear.
	 * 
	 * @attribute minHeight
	 * @type {Number} em&#x27;s
	 * @default 44 (em) 570px @ 13px font
	 */
	minHeight:
	{
		value:     44,
		validator: function(value)
		{
			return (Y.Lang.isNumber(value) &amp;&amp; value &gt; 0);
		}
	},

	/**
	 * In FIT_TO_CONTENT mode, set this to true to make the footer stick to
	 * the bottom of the viewport.  The default is for the footer to scroll
	 * along with the rest of the page content.
	 *
	 * @attribute stickyFooter
	 * @type {Boolean}
	 * @default false
	 */
	stickyFooter:
	{
		value:     false,
		validator: Y.Lang.isBoolean
	},

	/**
	 * When organizing modules into columns in FIT_TO_CONTENT mode, set
	 * this to false to allow each column to be a different height.
	 *
	 * @attribute matchColumnHeights
	 * @type {Boolean}
	 * @default true
	 */
	matchColumnHeights:
	{
		value:     true,
		validator: Y.Lang.isBoolean
	},

	/**
	 * Selector identifying the element which contains layout-(hd|bd|ft).
	 * This cannot be used to attach PageLayout to only part of the page.
	 * It should only be used when the page content is unavoidably embedded
	 * inside an element which fills the page.
	 * 
	 * @attribute body
	 * @type {String|Node}
	 * @default &quot;body&quot;
	 */
	body:
	{
		value:     &#x27;body&#x27;,
		validator: function(value)
		{
			return (Y.Lang.isString(value) || value._node);
		}
	}
};

/**
 * @event beforeReflow
 * @description Fires before the layout is reflowed.
 */
/**
 * @event afterReflow
 * @description Fires after the layout is completely reflowed, including viewport scrollbar changes.
 */

/**
 * @event beforeExpandModule
 * @description Fires before a module is expanded.
 * @param bd {Node} the module body (layout-m-bd)
 */
/**
 * @event afterExpandModule
 * @description Fires after a module is expanded.
 * @param bd {Node} the module body (layout-m-bd)
 */

/**
 * @event beforeCollapseModule
 * @description Fires before a module is collapsed.
 * @param bd {Node} the module body (layout-m-bd)
 */
/**
 * @event afterCollapseModule
 * @description Fires after a module is collapsed.
 * @param bd {Node} the module body (layout-m-bd)
 */

/**
 * @event beforeResizeModule
 * @description Fires before a module is resized.
 * @param bd {Node} the module body (layout-m-bd)
 * @param height {Number} new height in pixels or &quot;auto&quot;
 * @param width {Number} new width in pixels or &quot;auto&quot;
 */
/**
 * @event afterResizeModule
 * @description Fires after a module is resized.
 * @param bd {Node} the module body (layout-m-bd)
 * @param height {Number} new height in pixels
 * @param width {Number} new width in pixels
 */

/**
 * @property fit_to_viewport_class
 * @type {String}
 * @default &quot;FIT_TO_VIEWPORT&quot;
 * @static
 */
PageLayout.fit_to_viewport_class = &#x27;FIT_TO_VIEWPORT&#x27;;

/**
 * @property fit_to_content_class
 * @type {String}
 * @default &quot;FIT_TO_CONTENT&quot;
 * @static
 */
PageLayout.fit_to_content_class = &#x27;FIT_TO_CONTENT&#x27;;

/**
 * @property force_fit_class
 * @type {String}
 * @default &quot;FORCE_FIT&quot;
 * @static
 */
PageLayout.force_fit_class = &#x27;FORCE_FIT&#x27;;

/**
 * @property page_header_class
 * @type {String}
 * @default &quot;layout-hd&quot;
 * @static
 */
PageLayout.page_header_class = &#x27;layout-hd&#x27;;

/**
 * @property page_body_class
 * @type {String}
 * @default &quot;layout-bd&quot;
 * @static
 */
PageLayout.page_body_class = &#x27;layout-bd&#x27;;

/**
 * @property page_footer_class
 * @type {String}
 * @default &quot;layout-ft&quot;
 * @static
 */
PageLayout.page_footer_class = &#x27;layout-ft&#x27;;

/**
 * @property module_rows_class
 * @type {String}
 * @value &quot;layout-module-row&quot;
 * @static
 */
PageLayout.module_rows_class = &#x27;layout-module-row&#x27;;

/**
 * @property module_cols_class
 * @type {String}
 * @value &quot;layout-module-col&quot;
 * @static
 */
PageLayout.module_cols_class = &#x27;layout-module-col&#x27;;

/**
 * @property module_class
 * @type {String}
 * @default &quot;layout-module&quot;
 * @static
 */
PageLayout.module_class = &#x27;layout-module&#x27;;

/**
 * @property module_header_class
 * @type {String}
 * @default &quot;layout-m-hd&quot;
 * @static
 */
PageLayout.module_header_class = &#x27;layout-m-hd&#x27;;

/**
 * @property module_body_class
 * @type {String}
 * @default &quot;layout-m-bd&quot;
 * @static
 */
PageLayout.module_body_class = &#x27;layout-m-bd&#x27;;

/**
 * @property module_footer_class
 * @type {String}
 * @default &quot;layout-m-ft&quot;
 * @static
 */
PageLayout.module_footer_class = &#x27;layout-m-ft&#x27;;

/**
 * @property not_managed_class
 * @type {String}
 * @default &quot;layout-not-managed&quot;
 * @static
 */
PageLayout.not_managed_class = &#x27;layout-not-managed&#x27;;

/**
 * @property collapse_vert_nub_class
 * @type {String}
 * @default &quot;layout-vert-collapse-nub&quot;
 * @static
 */
PageLayout.collapse_vert_nub_class = &#x27;layout-vert-collapse-nub&#x27;;

/**
 * @property collapse_left_nub_class
 * @type {String}
 * @default &quot;layout-left-collapse-nub&quot;
 * @static
 */
PageLayout.collapse_left_nub_class = &#x27;layout-left-collapse-nub&#x27;;

/**
 * @property collapse_right_nub_class
 * @type {String}
 * @default &quot;layout-right-collapse-nub&quot;
 * @static
 */
PageLayout.collapse_right_nub_class = &#x27;layout-right-collapse-nub&#x27;;

/**
 * @property expand_vert_nub_class
 * @type {String}
 * @default &quot;layout-vert-expand-nub&quot;
 * @static
 */
PageLayout.expand_vert_nub_class = &#x27;layout-vert-expand-nub&#x27;;

/**
 * @property expand_left_nub_class
 * @type {String}
 * @default &quot;layout-left-expand-nub&quot;
 * @static
 */
PageLayout.expand_left_nub_class = &#x27;layout-left-expand-nub&#x27;;

/**
 * @property expand_right_nub_class
 * @type {String}
 * @default &quot;layout-right-expand-nub&quot;
 * @static
 */
PageLayout.expand_right_nub_class = &#x27;layout-right-expand-nub&#x27;;

/**
 * @property collapsed_vert_class
 * @type {String}
 * @default &quot;layout-collapsed-vert&quot;
 * @static
 */
PageLayout.collapsed_vert_class = &#x27;layout-collapsed-vert&#x27;;

/**
 * @property collapsed_horiz_class
 * @type {String}
 * @default &quot;layout-collapsed-horiz&quot;
 * @static
 */
PageLayout.collapsed_horiz_class = &#x27;layout-collapsed-horiz&#x27;;

/**
 * @property min_module_height
 * @type {Number}
 * @default 10 (px)
 * @static
 */
PageLayout.min_module_height = 10; // px

PageLayout.unmanaged_size = -1; // smaller than any module size (collapsed size = - normal size)

var mode_regex          = /\bFIT_TO_[A-Z_]+/,
	row_height_class_re = /(?:^|\s)height:([0-9]+)%/,
	col_width_class_re  = /(?:^|\s)width:([0-9]+)%/,

	reflow_delay = 100, // ms

	plugin_info =
	{
		row:
		{
			module:     &#x27;gallery-layout-rows&#x27;,
			plugin:     &#x27;PageLayoutRows&#x27;,
			outer_size: row_height_class_re,
			inner_size: col_width_class_re
		},
		col:
		{
			module:     &#x27;gallery-layout-cols&#x27;,
			plugin:     &#x27;PageLayoutCols&#x27;,
			outer_size: col_width_class_re,
			inner_size: row_height_class_re
		}
	};
/*
	dd_group_name:            &#x27;satg-layout-dd-group&#x27;,
	drag_target_class:        &#x27;satg-layout-dd-target&#x27;,
	drag_nub_class:           &#x27;satg-layout-dragnub&#x27;,
	module_header_drag_class: &#x27;satg-layout-draggable&#x27;,
	module_no_drag_class:     &#x27;satg-layout-drag-disabled&#x27;,
	bomb_sight_class:         &#x27;satg-layout-bomb-sight satg-layout-bomb-sight-rows&#x27;,

	the_dd_targets = {};
	the_dd_nubs    = {};
*/

function init()
{
	this.viewport =
	{
		w:   0,
		h:   0,
		bcw: 0
	};

	// find header, body, footer

	var page_blocks = Y.one(this.get(&#x27;body&#x27;)).get(&#x27;children&#x27;);

	var list = page_blocks.filter(&#x27;.&#x27;+PageLayout.page_header_class);
	if (list.size() &gt; 1)
	{
		throw Error(&#x27;There must be at most one div with class &#x27; + PageLayout.page_header_class);
	}
	this.header_container = (list.isEmpty() ? null : list.item(0));

	list = page_blocks.filter(&#x27;.&#x27;+PageLayout.page_body_class);
	if (list.size() != 1)
	{
		throw Error(&#x27;There must be exactly one div with class &#x27; + PageLayout.page_body_class);
	}
	this.body_container = list.item(0);

	this.body_horiz_mbp = this.body_container.horizMarginBorderPadding();
	this.body_vert_mbp  = this.body_container.vertMarginBorderPadding();

	var m = this.body_container.get(&#x27;className&#x27;).match(mode_regex);
	if (m &amp;&amp; m.length)
	{
		this.set(&#x27;mode&#x27;, PageLayout[ m[0] ]);
	}

	list = page_blocks.filter(&#x27;.&#x27;+PageLayout.page_footer_class);
	if (list.size() &gt; 1)
	{
		throw Error(&#x27;There must be at most one div with class &#x27; + PageLayout.page_footer_class);
	}
	this.footer_container = (list.isEmpty() ? null : list.item(0));

	Y.one(Y.config.win).on(&#x27;resize&#x27;, resize, this);

	updateFitClass.call(this);
	reparentFooter.call(this);
	this.rescanBody();

	// stay in sync

	this.after(&#x27;modeChange&#x27;, function()
	{
		updateFitClass.call(this);

		if (this.body_container)
		{
			this.body_container.scrollTop = 0;
		}

		reparentFooter.call(this);
		resize.call(this);
	});

	this.after(&#x27;minWidthChange&#x27;, resize);
	this.after(&#x27;minHeightChange&#x27;, resize);

	this.after(&#x27;stickyFooterChange&#x27;, function()
	{
		reparentFooter.call(this);
		resize.call(this);
	});

	this.after(&#x27;matchColumnHeightsChange&#x27;, resize);
}

/*
 * Normalize the list of sizes so they add up to 100%.
 */
function normalizeSizes(
	/* array */	list,
	/* regex */	pattern)
{
	// collect sizes

	var sizes = Y.map(list, function(module)
	{
		if (module.hasClass(PageLayout.not_managed_class))
		{
			return PageLayout.unmanaged_size;
		}

		var m = module.get(&#x27;className&#x27;).match(pattern);
		return (m &amp;&amp; m.length ? parseInt(m[1], 10) : 0);
	});

	// analyze

	var info = Y.reduce(sizes, [0,0], function(value, size)
	{
		if (size &gt; 0)
		{
			value[0] += size;
		}
		else if (size === 0)
		{
			value[1]++;
		}
		return value;
	});

	var sum = info[0], blank_count = info[1];

	// fill in blanks

	if (blank_count &gt; 0)
	{
		var blank_size = Math.max((100 - sum) / blank_count, 10);

		sizes = Y.map(sizes, function(size)
		{
			return (size === 0 ? blank_size : size);
		});

		sum = Y.reduce(sizes, 0, function(sum, size, i)
		{
			return (size &lt; 0 ? sum : sum + size);
		});
	}

	// normalize

	return Y.map(sizes, function(size)
	{
		return (size &gt; 0 ? size * (100.0 / sum) : size);
	});
}

function updateFitClass()
{
	this.body_container.replaceClass(&#x27;FIT_TO_(VIEWPORT|CONTENT)&#x27;,
		this.get(&#x27;mode&#x27;) === PageLayout.FIT_TO_VIEWPORT ? &#x27;FIT_TO_VIEWPORT&#x27; : &#x27;FIT_TO_CONTENT&#x27;);
}

function reparentFooter()
{
	if (!this.footer_container)
	{
		return;
	}

	if (this.get(&#x27;mode&#x27;) === PageLayout.FIT_TO_VIEWPORT || this.get(&#x27;stickyFooter&#x27;))
	{
		this.body_container.get(&#x27;parentNode&#x27;).insertBefore(this.footer_container, this.body_container.next(function(node)
		{
			return node.get(&#x27;tagName&#x27;) != &#x27;SCRIPT&#x27;;
		}));
	}
	else
	{
		this.body_container.appendChild(this.footer_container);
	}
}

function resize()
{
	if (!this.layout_plugin || !this.body_container)
	{
		return;
	}

	// check if viewport changed

	var mode          = this.single_module ? Y.PageLayout.FIT_TO_VIEWPORT : this.get(&#x27;mode&#x27;);
	var sticky_footer = this.get(&#x27;stickyFooter&#x27;);

	this.body_container.setStyle(&#x27;overflowX&#x27;,
		mode === Y.PageLayout.FIT_TO_CONTENT ? &#x27;auto&#x27; : &#x27;hidden&#x27;);
	this.body_container.setStyle(&#x27;overflowY&#x27;,
		mode === Y.PageLayout.FIT_TO_CONTENT ? &#x27;scroll&#x27; : &#x27;hidden&#x27;);

	var viewport =
	{
		w: Y.DOM.winWidth(),
		h: Y.DOM.winHeight()
	};

	var resize_event = arguments[0] &amp;&amp; arguments[0].type == &#x27;resize&#x27;;
	if (resize_event &amp;&amp;
		(viewport.w === this.viewport.w &amp;&amp;
		 viewport.h === this.viewport.h))
	{
		return;
	}

	this.viewport = viewport;

	this.fire(&#x27;beforeReflow&#x27;);	// after confirming that viewport really has changed

	saveScrollPositions.call(this);

	// set width of hd,bd,ft and height of bd

	var min_width  = Y.Node.emToPx(this.get(&#x27;minWidth&#x27;));
	var body_width = Math.max(this.viewport.w, min_width);
	if (this.header_container)
	{
		this.header_container.setStyle(&#x27;width&#x27;, body_width+&#x27;px&#x27;);
	}
	this.body_container.setStyle(&#x27;width&#x27;, (body_width - this.body_horiz_mbp)+&#x27;px&#x27;);
	if (this.footer_container)
	{
		this.footer_container.setStyle(&#x27;width&#x27;, sticky_footer ? body_width+&#x27;px&#x27; : &#x27;auto&#x27;);
	}
	body_width = this.body_container.get(&#x27;clientWidth&#x27;) - this.body_horiz_mbp;

	this.viewport.bcw = this.body_container.get(&#x27;clientWidth&#x27;);

	var h     = this.viewport.h;
	var h_min = Y.Node.emToPx(this.get(&#x27;minHeight&#x27;));
	if (mode === Y.PageLayout.FIT_TO_VIEWPORT &amp;&amp; h &lt; h_min)
	{
		h = h_min;
		Y.one(document.documentElement).setStyle(&#x27;overflowY&#x27;, &#x27;auto&#x27;);
	}
	else if (!window.console || !window.console.layout_force_viewport_scrollbars)	// remove inactive vertical scrollbar in IE
	{
		Y.one(document.documentElement).setStyle(&#x27;overflowY&#x27;, &#x27;hidden&#x27;);
	}

	if (this.header_container)
	{
		h -= this.header_container.get(&#x27;offsetHeight&#x27;);
	}
	if (this.footer_container &amp;&amp;
		(mode === Y.PageLayout.FIT_TO_VIEWPORT || sticky_footer))
	{
		h -= this.footer_container.get(&#x27;offsetHeight&#x27;);
	}

	if (mode === Y.PageLayout.FIT_TO_VIEWPORT)
	{
		var body_height = h - this.body_vert_mbp;
	}
	else if (h &lt; 0)						// FIT_TO_CONTENT doesn&#x27;t enforce min height
	{
		h = 10 + this.body_vert_mbp;	// arbitrary, positive number
	}

	this.body_container.setStyle(&#x27;height&#x27;, (h - this.body_vert_mbp)+&#x27;px&#x27;);

	// resize modules

	this.layout_plugin.resize.call(this, mode, body_width, body_height);

	restoreScrollPositions.call(this);

	// show body and footer

	this.body_container.setStyle(&#x27;visibility&#x27;, &#x27;visible&#x27;);
	if (this.footer_container)
	{
		this.footer_container.setStyle(&#x27;visibility&#x27;, &#x27;visible&#x27;);
	}

	Y.later(100, this, checkViewportSize);
}

/*
 * Check if the viewport size has changed, usually due to the browser
 * removing no-longer-needed scrollbars.  If the viewport size is
 * stable, fires the afterReflow event.
 */
function checkViewportSize()
{
	if (Y.DOM.winWidth()                       != this.viewport.w ||
		Y.DOM.winHeight()                      != this.viewport.h ||
		this.body_container.get(&#x27;clientWidth&#x27;) != this.viewport.bcw)
	{
		resize.call(this);
	}
	else
	{
		this.fire(&#x27;afterReflow&#x27;);
	}
}

function saveScrollPositions()
{
	var outer_count = this.body_info.outers.size();
	for (var i=0; i&lt;outer_count; i++)
	{
		var modules     = this.body_info.modules[i];
		var inner_count = modules.size();
		for (var j=0; j&lt;inner_count; j++)
		{
			var module   = modules.item(j),
				children = this._analyzeModule(module);

			module._page_layout = !children.bd ? null :
			{
				children:     children,
				bdScrollTop:  children.bd.get(&#x27;scrollTop&#x27;),
				bdScrollLeft: children.bd.get(&#x27;scrollLeft&#x27;)
			};
		}
	}
}

function restoreScrollPositions()
{
	var outer_count = this.body_info.outers.size();
	for (var i=0; i&lt;outer_count; i++)
	{
		var modules     = this.body_info.modules[i];
		var inner_count = modules.size();
		for (var j=0; j&lt;inner_count; j++)
		{
			var module = modules.item(j);
			if (module._page_layout)
			{
				var bd = module._page_layout.children.bd;
				bd.set(&#x27;scrollTop&#x27;, module._page_layout.bdScrollTop);
				bd.get(&#x27;scrollLeft&#x27;, module._page_layout.bdScrollLeft);
			};
		}
	}
}

/*
 * Expand the module containing the event target.
 */
function expandModule(
	/* event */	e)
{
	var node = e.currentTarget;

	function expand(
		/* string */	parent_class_name,
		/* string */	collapsed_class)
	{
		var p = node.getAncestorByClassName(this.layout_plugin.collapse_classes[parent_class_name]);
		if (p &amp;&amp; p.hasClass(collapsed_class))
		{
			var children = this._analyzeModule(p);
			this.fire(&#x27;beforeExpandModule&#x27;, { bd: children.bd });

			p.removeClass(collapsed_class);
			resize.call(this);

			this.fire(&#x27;afterExpandModule&#x27;, { bd: children.bd });
		}
	}

	if (node.hasClass(PageLayout.expand_vert_nub_class))
	{
		expand.call(this, &#x27;vert_parent_class&#x27;, PageLayout.collapsed_vert_class);
	}
	else
	{
		expand.call(this, &#x27;horiz_parent_class&#x27;, PageLayout.collapsed_horiz_class);
	}
}

/*
 * Collapse the module containing the event target.
 */
function collapseModule(
	/* event */	e)
{
	var node = e.currentTarget;

	function collapse(
		/* string */	parent_class_name,
		/* string */	collapsed_class)
	{
		var p = node.getAncestorByClassName(this.layout_plugin.collapse_classes[parent_class_name]);
		if (p &amp;&amp; !p.hasClass(collapsed_class))
		{
			var children = this._analyzeModule(p);
			this.fire(&#x27;beforeCollapseModule&#x27;, { bd: children.bd });

			p.addClass(collapsed_class);
			resize.call(this);

			this.fire(&#x27;afterCollapseModule&#x27;, { bd: children.bd });
		}
	}

	if (node.hasClass(PageLayout.collapse_vert_nub_class))
	{
		collapse.call(this, &#x27;vert_parent_class&#x27;, PageLayout.collapsed_vert_class);
	}
	else
	{
		collapse.call(this, &#x27;horiz_parent_class&#x27;, PageLayout.collapsed_horiz_class);
	}
}

Y.extend(PageLayout, Y.Base,
{
	initializer: function()
	{
		Y.on(&#x27;domready&#x27;, init, this);
	},

	/**
	 * Call this after manually adding or removing modules on the page.
	 * 
	 * @method rescanBody
	 */
	rescanBody: function()
	{
		Y.detach(&#x27;PageLayoutCollapse|click&#x27;);

		this.body_info =
		{
			outers:      [],
			modules:     [],	// list of modules inside each row
			outer_sizes: [],	// list of percentages
			inner_sizes: []		// list of lists of percentages
		};

		var outer_list  = this.body_container.all(&#x27;div.&#x27; + PageLayout.module_rows_class);
		var plugin_data = plugin_info.row;
		if (outer_list.isEmpty())
		{
			outer_list  = this.body_container.all(&#x27;div.&#x27; + PageLayout.module_cols_class);
			plugin_data = plugin_info.col;
		}
		if (outer_list.isEmpty())
		{
			throw Error(&#x27;There must be at least one &#x27; + PageLayout.module_rows_class + &#x27; or &#x27; + PageLayout.module_cols_class + &#x27; inside &#x27; + PageLayout.page_body_class + &#x27;.&#x27;);
		}
		this.body_info.outers = outer_list;

		var collapse_nub_pattern =
			&#x27;(&#x27; +
			PageLayout.collapse_vert_nub_class + &#x27;|&#x27; +
			PageLayout.collapse_left_nub_class + &#x27;|&#x27; +
			PageLayout.collapse_right_nub_class +
			&#x27;)&#x27;;

		var expand_nub_pattern =
			&#x27;(&#x27; +
			PageLayout.expand_vert_nub_class + &#x27;|&#x27; +
			PageLayout.expand_left_nub_class + &#x27;|&#x27; +
			PageLayout.expand_right_nub_class +
			&#x27;)&#x27;;

		var row_count = this.body_info.outers.size();
		Y.each(this.body_info.outers, function(row)
		{
			var row_id = row.generateID();
			this.body_info.outer_sizes.push(100.0/row_count);

			var list = row.all(&#x27;div.&#x27; + PageLayout.module_class);
			if (list.isEmpty())
			{
				this.body_info.outers  = [];
				this.body_info.modules = [];
				throw Error(&#x27;There must be at least one &#x27; + PageLayout.module_class + &#x27; inside &#x27; + PageLayout.module_rows_class + &#x27;.&#x27;);
			}

			this.body_info.modules.push(list);

			Y.each(list, function(module)
			{
				var nub = module.getFirstElementByClassName(collapse_nub_pattern);
				if (nub)
				{
					nub.on(&#x27;PageLayoutCollapse|click&#x27;, collapseModule, this);
				}

				nub = module.getFirstElementByClassName(expand_nub_pattern);
				if (nub)
				{
					nub.on(&#x27;PageLayoutCollapse|click&#x27;, expandModule, this);
				}
			},
			this);
/*
			if (PageLayoutDDProxy)
			{
				var has_nubs = false;
				Y.each(list, function(module)
				{
					var id = module.generateID();
					module.removeClass(PageLayout.module_no_drag_class);

					if (the_dd_nubs[id])
					{
						has_nubs = (the_dd_nubs[id] != &#x27;none&#x27;);
					}
					else
					{
						var nub = module.getFirstElementByClassName(PageLayout.drag_nub_class);
						if (nub)
						{
							var children = this._analyzeModule(module);
							if (children.hd)
							{
								children.hd.addClass(PageLayout.module_header_drag_class);
								the_dd_nubs[id] =
									new PageLayoutDDProxy(this, id, children.hd, PageLayout.dd_group_name);
								has_nubs = true;
							}
						}

						if (!the_dd_nubs[id])
						{
							the_dd_nubs[id] = &#x27;none&#x27;;
						}
					}
				},
				this);

				if (!the_dd_targets[ row_id ] &amp;&amp;
					(has_nubs || row.hasClass(PageLayout.drag_target_class)))
				{
					the_dd_targets[ row_id ] = new DDTarget(row_id, PageLayout.dd_group_name);
				}

				if (list.size() == 1)
				{
					list.item(0).addClass(PageLayout.module_no_drag_class);
				}
			}
*/
			this.body_info.inner_sizes.push(
				normalizeSizes(list, plugin_data.inner_size));
		},
		this);

		this.body_info.outer_sizes =
			normalizeSizes(this.body_info.outers, plugin_data.outer_size);

		this.single_module = false;
		if (this.body_info.outers.size() == 1 &amp;&amp; this.body_info.modules[0].size() == 1 &amp;&amp;
			!this.body_container.hasClass(PageLayout.force_fit_class))
		{
			plugin_data        = plugin_info.row;
			this.single_module = true;
		}

		var self = this;
		Y.use(plugin_data.module, function(Y)
		{
			Y.all(&#x27;div.layout-loading&#x27;).each(function(n)
			{
				n.setStyle(&#x27;display&#x27;, &#x27;none&#x27;);
			});

			self.layout_plugin = Y[ plugin_data.plugin ];
			updateFitClass.call(self);	// plugin may modify it
			resize.call(self);
		});
	},

	/**
	 * @method getHeaderHeight
	 * @return {Number} the height of the sticky header in pixels
	 */
	getHeaderHeight: function()
	{
		return (this.header_container ? this.header_container.get(&#x27;offsetHeight&#x27;) : 0);
	},

	/**
	 * @method getHeaderContainer
	 * @return {Node} the header container (layout-hd) or null if there is no header
	 */
	getHeaderContainer: function()
	{
		return this.header_container;
	},

	/**
	 * @method getBodyHeight
	 * @return {Number} the height of the scrolling body in pixels
	 */
	getBodyHeight: function()
	{
		return this.body_container.get(&#x27;offsetHeight&#x27;);
	},

	/**
	 * @method getBodyContainer
	 * @return {Node} the body container (layout-bd)
	 */
	getBodyContainer: function()
	{
		return this.body_container;
	},

	/**
	 * @method getFooterHeight
	 * @return {Number} the height of the sticky footer in pixels or zero if the footer is not sticky
	 */
	getFooterHeight: function()
	{
		return (this.get(&#x27;stickyFooter&#x27;) &amp;&amp; this.footer_container ?
				this.footer_container.get(&#x27;offsetHeight&#x27;) : 0);
	},

	/**
	 * @method getFooterContainer
	 * @return {Node} the footer container (layout-ft), or null if there is no footer
	 */
	getFooterContainer: function()
	{
		return this.footer_container;
	},

	/**
	 * @method moduleIsCollapsed
	 * @param node {String|Node} .layout-module
	 * @return {Boolean} true if module is collapsed
	 */
	moduleIsCollapsed: function(
		/* string/Node */	node)
	{
		var collapsed_pattern =
			&#x27;(&#x27; +
			PageLayout.collapsed_horiz_class + &#x27;|&#x27; +
			PageLayout.collapses_vert_class +
			&#x27;)&#x27;;

		node = Y.one(node);
		if (node.getFirstElementByClassName(this.layout_plugin.collapse_classes.collapse_parent_pattern))
		{
			node = node.get(&#x27;parentNode&#x27;);
		}

		return node.hasClass(collapsed_pattern);
	},

	/**
	 * Expand the specified module.
	 * 
	 * @method expandModule
	 * @param node {String|Node} .layout-module
	 */
	expandModule: function(
		/* string/Node */	node)
	{
		node    = Y.one(node);
		var nub = node.getFirstElementByClassName(PageLayout.expand_vert_nub_class);
		if (!nub)
		{
			var expand_horiz_nub_pattern =
				&#x27;(&#x27; +
				PageLayout.expand_left_nub_class + &#x27;|&#x27; +
				PageLayout.expand_right_nub_class +
				&#x27;)&#x27;;

			nub = node.getFirstElementByClassName(expand_horiz_nub_pattern);
		}

		if (nub)
		{
			expandModule.call(this, { currentTarget: nub });
		}
	},

	/**
	 * Collapse the specified module.
	 * 
	 * @method collapseModule
	 * @param node {String|Node} .layout-module
	 */
	collapseModule: function(
		/* string/Node */	node)
	{
		node    = Y.one(node);
		var nub = node.getFirstElementByClassName(PageLayout.collapse_vert_nub_class);
		if (!nub)
		{
			var collapse_horiz_nub_pattern =
				&#x27;(&#x27; +
				PageLayout.collapse_left_nub_class + &#x27;|&#x27; +
				PageLayout.collapse_right_nub_class +
				&#x27;)&#x27;;

			nub = node.getFirstElementByClassName(collapse_horiz_nub_pattern);
		}

		if (nub)
		{
			collapseModule.call(this, { currentTarget: nub });
		}
	},

	/**
	 * Toggle the collapsed state of the specified layout-module.
	 * 
	 * @method toggleModule
	 * @param module {String|Node} .layout-module
	 */
	toggleModule: function(
		/* string/Node */	module)
	{
		module = Y.one(module);	// optimization
		if (this.moduleIsCollapsed(module))
		{
			this.expandModule(module);
		}
		else
		{
			this.collapseModule(module);
		}
	},

	/**
	 * Call this when something changes size, to request a reflow of the
	 * layout.
	 * 
	 * @method elementResized
	 * @param el {String|Node} element that changed size
	 * @return {Boolean} true if the element is inside the managed containers
	 */
	elementResized: function(
		/* string/Node */	el)
	{
		el = Y.one(el);

		if ((this.header_container &amp;&amp; this.header_container.contains(el)) ||
			(this.body_container &amp;&amp; this.body_container.contains(el)) ||
			(this.footer_container &amp;&amp; this.footer_container.contains(el)))
		{
			if (this.refresh_timer)
			{
				this.refresh_timer.cancel();
			}

			var t1 = (new Date()).getTime();
			this.refresh_timer = Y.later(reflow_delay, this, function()
			{
				this.refresh_timer = null;

				// if JS is really busy, wait a bit longer

				var t2 = (new Date()).getTime();
				if (t2 &gt; t1 + 2*reflow_delay)
				{
					Y.log(&#x27;deferred reflow: &#x27; + (t2-t1), &#x27;info&#x27;, &#x27;layout&#x27;);
					this.elementResized(el);
				}
				else
				{
					resize.call(this);
				}
			});

			return true;
		}
		else
		{
			return false;
		}
	},

	/**
	 * Returns the components of the module.
	 * 
	 * @method _analyzeModule
	 * @private
	 * @param root {Node} .layout-module
	 * @return {Object} root,hd,bd,ft
	 */
	_analyzeModule: function(
		/* node */	root)
	{
		var result =
		{
			root: root,
			hd:   null,
			bd:   null,
			ft:   null
		};

		// two step process avoid scanning into the module body

		var bd = root.one(&#x27;.&#x27;+PageLayout.module_body_class);
		if (!bd)
		{
			return result;
		}

		var list = bd.siblings().filter(&#x27;.&#x27;+PageLayout.module_body_class);
		list.unshift(bd);
		result.bd = list.find(function(n)
		{
			return (n.get(&#x27;offsetWidth&#x27;) &gt; 0);
		});
		if (!result.bd)
		{	
			result.bd = bd;
		}

		if (result.bd)
		{
			result.hd = result.bd.siblings().filter(&#x27;.&#x27;+PageLayout.module_header_class).item(0);
			result.ft = result.bd.siblings().filter(&#x27;.&#x27;+PageLayout.module_footer_class).item(0);
		}

		return result;
	},

	/**
	 * Set the width of a module.
	 * 
	 * @method _setWidth
	 * @private
	 * @param children {Object} root,hd,bd,ft
	 * @param w {Number} width in pixels
	 */
	_setWidth: function(
		/* object */	children,
		/* int */		w)
	{
		children.root.setStyle(&#x27;width&#x27;, w+&#x27;px&#x27;);
	}
});

Y.PageLayout = PageLayout;

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
