<!DOCTYPE HTML>
<html>
<head>
	<title>YUI 3 QueryBuilder Example</title>
	<meta http-equiv=content-type content="text/html; charset=utf-8">

	<script src="https://jafl.github.io/yui3/build/yui/yui-min.js"></script>
	<link rel="stylesheet" type="text/css" href="https://jafl.github.io/yui3/build/cssreset/cssreset-min.css">

	<script src="gallery-querybuilder-debug.js"></script>
	<script src="gallery-formmgr-debug.js"></script>
	<script src="gallery-formmgr-css-validation-debug.js"></script>
	<script src="gallery-node-optimizations-debug.js"></script>
	<link rel="stylesheet" type="text/css" href="assets/gallery-querybuilder.css" />
	<script src="gallery-querybuilder-multiselect-input-debug.js"></script>
	<script src="gallery-querybuilder-daterange-debug.js"></script>
	<link rel="stylesheet" type="text/css" href="assets/gallery-querybuilder-daterange.css" />
	<script src="gallery-datetime-debug.js"></script>
	<link rel="stylesheet" type="text/css" href="assets/gallery-datetime.css" />
	<script src="gallery-datetime-range-debug.js"></script>
	<script src="gallery-input-calendar-sync-debug.js"></script>
	<script src="gallery-datetime-utils-debug.js"></script>
	<script src="gallery-popup-debug.js"></script>
	<link rel="stylesheet" type="text/css" href="assets/gallery-popup.css" />
	<script src="gallery-node-event-set-debug.js"></script>
	<script src="gallery-timepicker-debug.js"></script>
	<link rel="stylesheet" type="text/css" href="assets/gallery-timepicker.css" />

	<style type="text/css">
	#query
	{
		margin-top: 10px;
		border: 1px solid black;
		padding: 10px;
	}

	#controls
	{
		margin-top: 10px;
	}

	.plug
	{
		margin: 10px 0;
	}

	.yui3-aclist-aria
	{
		display: none;
	}
	</style>
</head>
<body class="yui3-skin-sam">

<h1>YUI 3 QueryBuilder Example</h1>

<form name="query_form">
	<div id="query"></div>
</form>

<div id="controls">
	<button id="validate">Validate</button>
	<button id="db-query">Log as DB Query</button>
</div>

<p class="plug">For a more general way to build an expression, see Expression Builder.

<p><a href="index.html">Show me an example using DataTable</a></p>
<p><a href="../yuidoc/modules/gallery-querybuilder.html">Show me the documentation</a></p>
<p><a href="/yui-modules/">Back to project list</a></p>

<script type="text/javascript">
YUI({
	filter: 'raw', combine: false,
	gallery: 'gallery-2014.02.20-23-55'
}).use(
	'gallery-querybuilder', 'gallery-querybuilder-multiselect-input',
	'gallery-querybuilder-daterange', 'gallery-timepicker',
	'autocomplete', 'autocomplete-filters', 'autocomplete-highlighters',
function(Y)
{
	Y.QueryBuilder.plugin_mapping[ 'my-simple-multiselect-input' ] = Y.QueryBuilder.MultiselectInput;

	var url_list =
	[
		'autos.yahoo.com',
		'bing.com',
		'cnn.com',
		'delicious.com',
		'facebook.com',
		'finance.yahoo.com',
		'flickr.com',
		'games.yahoo.com',
		'google.com',
		'health.yahoo.net',
		'mail.yahoo.com',
		'messenger.yahoo.com',
		'movies.yahoo.com',
		'netflix.com',
		'news.yahoo.com',
		'omg.yahoo.com',
		'pulse.yahoo.com',
		'realestate.yahoo.com',
		'reuters.com',
		'search.yahoo.com',
		'shine.yahoo.com',
		'shopping.yahoo.com',
		'sports.yahoo.com',
		'travel.yahoo.com',
		'twitter.com',
		'weather.yahoo.com',
		'yahoo.com',
		'yahoo.match.com'
	];

	var var_list =
	[
		{
			name:       'url',
			type:       'string',
			text:       'URL',
			validation: 'yiv-length:[,3000]',
			autocomplete:
			{
				source:             url_list,
				resultFilters:      'startsWith',
				resultHighlighter:  'phraseMatch',
				containerClassName: 'my-custom-class'
			}
		},
		{
			name:       'extra-urls',
			type:       'multiselect-input',
			text:       'Extra URLs',
			value_list: url_list
		},
		{
			name:       'more-urls',
			type:       'my-simple-multiselect-input',
			text:       'More URLs',
			value_list: url_list
		},
		{
			name:       'impressions',
			type:       'number',
			text:       'Impressions (1000\'s)',
			validation: 'yiv-integer'
		},
		{
			name:       'ctr',
			type:       'number',
			text:       'Click-through rate (%)',
			validation: 'yiv-decimal:[0,]'
		},
		{
			name: 'flag',
			type: 'select',
			text: 'Flagged',
			value_list:
			[
				{ value: "true",  text: 'True' },
				{ value: "false", text: 'False' }
			]
		},
		{
			name: 'submission_status',
			type: 'select',
			text: 'Status',
			value_list:
			[
				{ value: "I", text: 'Action Required' },
				{ value: "S", text: 'Submitted' },
				{ value: "A", text: 'Submission Accepted' },
				{ value: "B", text: 'Submission Auto-Accepted' }
			]
		},
		{
			name: 'date_range',
			type: 'daterange',
			text: 'Date range'
		},
		{
			name: 'date_time_range',
			type: 'daterange',
			text: 'Date/Time range',
			show_time: true
		}
	];

	var ops =
	{
		string:
		[
			{ value: 'equal',       text: 'Is' },
			{ value: 'contains',    text: 'Contains' },
			{ value: 'starts-with', text: 'Starts with' },
			{ value: 'ends-with',   text: 'Ends with' }
		],

		number:
		[
			{ value: 'equal',         text: '= Equals' },
			{ value: 'less',          text: '< Less than' },
			{ value: 'less-equal',    text: '<= Less than or equal to' },
			{ value: 'greater',       text: '> Greater than' },
			{ value: 'greater-equal', text: '>= Greater than or equal to' }
		],

		select:
		[
			'equals'
		],

		daterange:
		[
			'>', '<'
		],

		'multiselect-input':
		[
			{ value: 'in',     text: 'Is one of' },
			{ value: 'not-in', text: 'Is NOT one of' }
		],

		'my-simple-multiselect-input':
		[
			'is'
		]
	};

	var query = new Y.QueryBuilder(var_list, ops);
	query.render('#query');

	// You could use Y.FormManager.validateForm() instead,
	// if this is part of a larger form.

	Y.on('click', query.validateFields, '#validate', query);

	Y.on('click', function()
	{
		console.log(query.toDatabaseQuery());
	},
	'#db-query');
});
</script>

</body>
</html>
