<!DOCTYPE HTML>
<html>

<head>
	<title>Async Function DataSource Unit Tests</title>
	<meta http-equiv=content-type content="text/html; charset=utf-8">

	<script src="http://jafl.github.io/yui3/build/yui/yui-min.js"></script>
	<script src="gallery-datasource-async-function-debug.js"></script>
</head>

<body class="yui3-skin-sam">

<h1><a href="http://yuilibrary.com/gallery/show/datasource-async-function">YUI 3 Async Function DataSource</a> Unit Tests</h1>

<p><a href="../yuidoc/modules/gallery-datasource-async-function.html">Show me the documentation</a></p>
<p><a href="/yui-modules/">Back to project list</a></p>

<hr>

<p>Test result:  <span id="result"></span></p>

<script type="text/javascript">
YUI({
//	filter: 'raw', combine: false,
	gallery: 'gallery-2014.02.20-23-55'
}).use(
	'gallery-datasource-async-function', 'node',
function(Y)
{
	var ds = new Y.DataSource.AsyncFunction(
	{
		source: function(callback, request)
		{
			Y.later(10, null, function()
			{
				callback(null,
				{
					data: [1,2,3],
					meta: { foo: 'bar' }
				});
			});
		}
	});

	var result = Y.one('#result');
	ds.sendRequest(
	{
		request: null,
		callback:
		{
			success: function(e)
			{
				if (e.response.results.length == 3 && e.response.meta.foo == 'bar')
				{
					result.set('innerHTML', 'success');
				}
				else
				{
					result.set('innerHTML', 'incorrect data');
				}
			},
			failure: function(e)
			{
				result.set('innerHTML', e.error.message);
			}
		}
	});
});
</script>

</body>
</html>
